
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>simcardems.ORdmm_Land &#8212; simcardems  documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">simcardems  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../install.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../theory.html">
   Mathematical Theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../mechanics_model.html">
     Tissue level mechanics model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../electrophysiology_model.html">
     Tissue level electrophysiology model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../cell_model.html">
     Cellular model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../electro_mechanical_coupling.html">
     Electro-Mechanical coupling
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../demo.html">
   Demo
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../simple_demo.html">
     Simple demo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../cli.html">
     Command line interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../docker.html">
     Run using docker
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../release_test.html">
     Release test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gui.html">
     Graphical user interface
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../CONTRIBUTING.html">
   Contributing
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../modules.html">
   simcardems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../simcardems.html">
     simcardems package
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <a href="https://www.simula.no/research/projects/department-computational-physiology">Computational Physiology at Simula</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ComputationalPhysiology/simcardems"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ComputationalPhysiology/simcardems/issues/new?title=Issue%20on%20page%20%2F_modules/simcardems/ORdmm_Land.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <h1>Source code for simcardems.ORdmm_Land</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module contains a ORdmm_Land_em_coupling cardiac cell model</span>

<span class="sd">The module was autogenerated from a gotran ode file</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="kn">import</span> <span class="nn">dolfin</span>
<span class="kn">import</span> <span class="nn">ufl</span>
<span class="kn">from</span> <span class="nn">cbcbeat.cellmodels</span> <span class="kn">import</span> <span class="n">CardiacCellModel</span>
<span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="n">as_vector</span>
<span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="n">Constant</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utils</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="Max"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.Max">[docs]</a><span class="k">def</span> <span class="nf">Max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span> <span class="o">/</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span></div>


<div class="viewcode-block" id="Min"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.Min">[docs]</a><span class="k">def</span> <span class="nf">Min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span> <span class="o">/</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span></div>


<div class="viewcode-block" id="vs_functions_to_dict"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.vs_functions_to_dict">[docs]</a><span class="k">def</span> <span class="nf">vs_functions_to_dict</span><span class="p">(</span><span class="n">vs</span><span class="p">):</span>
    <span class="n">state_names</span> <span class="o">=</span> <span class="n">ORdmm_Land</span><span class="o">.</span><span class="n">default_initial_conditions</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">sub_function</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">state_names</span><span class="p">)</span>
    <span class="p">}</span></div>


<div class="viewcode-block" id="ORdmm_Land"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.ORdmm_Land">[docs]</a><span class="k">class</span> <span class="nc">ORdmm_Land</span><span class="p">(</span><span class="n">CardiacCellModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_conditions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create cardiac cell model</span>

<span class="sd">        *Arguments*</span>
<span class="sd">         params (dict, :py:class:`dolfin.Mesh`, optional)</span>
<span class="sd">           optional model parameters</span>
<span class="sd">         init_conditions (dict, :py:class:`dolfin.Mesh`, optional)</span>
<span class="sd">           optional initial conditions</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">init_conditions</span><span class="p">)</span>

<div class="viewcode-block" id="ORdmm_Land.default_parameters"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.ORdmm_Land.default_parameters">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">default_parameters</span><span class="p">(</span><span class="n">disease_state</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;healthy&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Set-up and return default parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        disease_state : str, optional</span>
<span class="sd">            String with &quot;hf&quot; or &quot;healthy&quot;, by default &quot;healthy&quot;.</span>
<span class="sd">            If &quot;hf&quot;, then parameters representing heart failure</span>
<span class="sd">            will be used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OrderedDict</span>
<span class="sd">            Dictionary with default values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;scale_ICaL&quot;</span><span class="p">,</span> <span class="mf">1.018</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_IK1&quot;</span><span class="p">,</span> <span class="mf">1.414</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_IKr&quot;</span><span class="p">,</span> <span class="mf">1.119</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_IKs&quot;</span><span class="p">,</span> <span class="mf">1.648</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_INaL&quot;</span><span class="p">,</span> <span class="mf">2.274</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;celltype&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;cao&quot;</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;nao&quot;</span><span class="p">,</span> <span class="mf">140.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="mf">96485.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="mf">8314.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="mf">310.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="mf">0.0011</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Ahf&quot;</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;GNa&quot;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;thL&quot;</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Gto&quot;</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;delta_epi&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Aff&quot;</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Kmn&quot;</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k2n&quot;</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;tjca&quot;</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;zca&quot;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;bt&quot;</span><span class="p">,</span> <span class="mf">4.75</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Beta0&quot;</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Beta1&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Tot_A&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Tref&quot;</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Trpn50&quot;</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;calib&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;cat50_ref&quot;</span><span class="p">,</span> <span class="mf">0.805</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;emcoupling&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;etal&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;etas&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;gammas&quot;</span><span class="p">,</span> <span class="mf">0.0085</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;gammaw&quot;</span><span class="p">,</span> <span class="mf">0.615</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;isacs&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ktrpn&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ku&quot;</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kuw&quot;</span><span class="p">,</span> <span class="mf">0.182</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kws&quot;</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ntm&quot;</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ntrpn&quot;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;p_a&quot;</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;p_b&quot;</span><span class="p">,</span> <span class="mf">9.1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;p_k&quot;</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mf">2.23</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;rs&quot;</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;rw&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;CaMKo&quot;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;KmCaM&quot;</span><span class="p">,</span> <span class="mf">0.0015</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;KmCaMK&quot;</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;aCaMK&quot;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;bCaMK&quot;</span><span class="p">,</span> <span class="mf">0.00068</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;PKNa&quot;</span><span class="p">,</span> <span class="mf">0.01833</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Gncx&quot;</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;KmCaAct&quot;</span><span class="p">,</span> <span class="mf">0.00015</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kasymm&quot;</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kcaoff&quot;</span><span class="p">,</span> <span class="mf">5000.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kcaon&quot;</span><span class="p">,</span> <span class="mf">1500000.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kna1&quot;</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kna2&quot;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kna3&quot;</span><span class="p">,</span> <span class="mf">88.12</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;qca&quot;</span><span class="p">,</span> <span class="mf">0.167</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;qna&quot;</span><span class="p">,</span> <span class="mf">0.5224</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;wca&quot;</span><span class="p">,</span> <span class="mf">60000.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;wna&quot;</span><span class="p">,</span> <span class="mf">60000.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;wnaca&quot;</span><span class="p">,</span> <span class="mf">5000.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="mf">1e-07</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Khp&quot;</span><span class="p">,</span> <span class="mf">1.698e-07</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Kki&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Kko&quot;</span><span class="p">,</span> <span class="mf">0.3582</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Kmgatp&quot;</span><span class="p">,</span> <span class="mf">1.698e-07</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Knai0&quot;</span><span class="p">,</span> <span class="mf">9.073</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Knao0&quot;</span><span class="p">,</span> <span class="mf">27.78</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Knap&quot;</span><span class="p">,</span> <span class="mf">224.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Kxkur&quot;</span><span class="p">,</span> <span class="mf">292.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;MgADP&quot;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;MgATP&quot;</span><span class="p">,</span> <span class="mf">9.8</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Pnak&quot;</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.155</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;eP&quot;</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k1m&quot;</span><span class="p">,</span> <span class="mf">182.4</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k1p&quot;</span><span class="p">,</span> <span class="mf">949.5</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k2m&quot;</span><span class="p">,</span> <span class="mf">39.4</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k2p&quot;</span><span class="p">,</span> <span class="mf">687.2</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k3m&quot;</span><span class="p">,</span> <span class="mf">79300.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k3p&quot;</span><span class="p">,</span> <span class="mf">1899.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k4m&quot;</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;k4p&quot;</span><span class="p">,</span> <span class="mf">639.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;zk&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;GKb&quot;</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;PNab&quot;</span><span class="p">,</span> <span class="mf">3.75e-10</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;PCab&quot;</span><span class="p">,</span> <span class="mf">2.5e-08</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;GpCa&quot;</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Esac_ns&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Gsac_k&quot;</span><span class="p">,</span> <span class="mf">1.097904761904762</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Gsac_ns&quot;</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;lambda_max&quot;</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;amp&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">80.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;BSLmax&quot;</span><span class="p">,</span> <span class="mf">1.124</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;BSRmax&quot;</span><span class="p">,</span> <span class="mf">0.047</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;KmBSL&quot;</span><span class="p">,</span> <span class="mf">0.0087</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;KmBSR&quot;</span><span class="p">,</span> <span class="mf">0.00087</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;cmdnmax&quot;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;csqnmax&quot;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kmcmdn&quot;</span><span class="p">,</span> <span class="mf">0.00238</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kmcsqn&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kmtrpn&quot;</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;trpnmax&quot;</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">),</span>
                <span class="c1"># Drug factors</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_INa&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_INaL&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_Ito&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_ICaL&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_IKr&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_IKs&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_IK1&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_IKb&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_INab&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_ICab&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_IpCa&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_Isacns&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_drug_Isack&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="c1"># Population factors</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GNa&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GCaL&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_Gto&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GNaL&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GKr&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GKs&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GK1&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GbK&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_KNCX&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_KNaK&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GbNa&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_GbCa&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_KpCa&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_KRyR&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_KSERCA&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_Kleak&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_nTm&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_CaT50ref&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_Tref&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_kuw&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_kws&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_kTRPN&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_nTRPN&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_ku&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_TRPN50&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_rw&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;scale_popu_rs&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="c1"># HF scaling factors</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_CaMKa&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_Jrel_inf&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_Jleak&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_Jup&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_GNaL&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_GK1&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_thL&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_Gto&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_Gncx&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_Pnak&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;HF_scaling_cat50_ref&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">disease_state</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;hf&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Update scaling parameters for heart failure model&quot;</span><span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_CaMKa&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.50</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Jrel_inf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Jleak&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.3</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Jup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.45</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_GNaL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.3</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_GK1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.68</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_thL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.8</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Gto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Gncx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.6</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Pnak&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;HF_scaling_cat50_ref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span>

        <span class="k">return</span> <span class="n">params</span></div>

<div class="viewcode-block" id="ORdmm_Land.default_initial_conditions"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.ORdmm_Land.default_initial_conditions">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">default_initial_conditions</span><span class="p">():</span>
        <span class="s2">&quot;Set-up and return default initial conditions.&quot;</span>
        <span class="n">ic</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">87</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;CaMKt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;hf&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;hs&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;hsp&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;jp&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;mL&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;hL&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;hLp&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;iF&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;iS&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ap&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;iFp&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;iSp&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ff&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;fs&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;fcaf&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;fcas&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;jca&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ffp&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;fcafp&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;nca&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;xrf&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;xrs&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;xs1&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;xs2&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;xk1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Jrelnp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Jrelp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;nai&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;nass&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;ki&quot;</span><span class="p">,</span> <span class="mi">145</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;kss&quot;</span><span class="p">,</span> <span class="mi">145</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;cass&quot;</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;cansr&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;cajsr&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;XS&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;XW&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;CaTrpn&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;TmB&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Cd&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;cai&quot;</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;lmbda&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Zetas&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Zetaw&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">ic</span></div>

    <span class="k">def</span> <span class="nf">_I</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Original gotran transmembrane current dV/dt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="k">if</span> <span class="n">time</span> <span class="k">else</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># Assign states</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">48</span>
        <span class="p">(</span>
            <span class="n">CaMKt</span><span class="p">,</span>
            <span class="n">m</span><span class="p">,</span>
            <span class="n">hf</span><span class="p">,</span>
            <span class="n">hs</span><span class="p">,</span>
            <span class="n">j</span><span class="p">,</span>
            <span class="n">hsp</span><span class="p">,</span>
            <span class="n">jp</span><span class="p">,</span>
            <span class="n">mL</span><span class="p">,</span>
            <span class="n">hL</span><span class="p">,</span>
            <span class="n">hLp</span><span class="p">,</span>
            <span class="n">a</span><span class="p">,</span>
            <span class="n">iF</span><span class="p">,</span>
            <span class="n">iS</span><span class="p">,</span>
            <span class="n">ap</span><span class="p">,</span>
            <span class="n">iFp</span><span class="p">,</span>
            <span class="n">iSp</span><span class="p">,</span>
            <span class="n">d</span><span class="p">,</span>
            <span class="n">ff</span><span class="p">,</span>
            <span class="n">fs</span><span class="p">,</span>
            <span class="n">fcaf</span><span class="p">,</span>
            <span class="n">fcas</span><span class="p">,</span>
            <span class="n">jca</span><span class="p">,</span>
            <span class="n">ffp</span><span class="p">,</span>
            <span class="n">fcafp</span><span class="p">,</span>
            <span class="n">nca</span><span class="p">,</span>
            <span class="n">xrf</span><span class="p">,</span>
            <span class="n">xrs</span><span class="p">,</span>
            <span class="n">xs1</span><span class="p">,</span>
            <span class="n">xs2</span><span class="p">,</span>
            <span class="n">xk1</span><span class="p">,</span>
            <span class="n">Jrelnp</span><span class="p">,</span>
            <span class="n">Jrelp</span><span class="p">,</span>
            <span class="n">nai</span><span class="p">,</span>
            <span class="n">nass</span><span class="p">,</span>
            <span class="n">ki</span><span class="p">,</span>
            <span class="n">kss</span><span class="p">,</span>
            <span class="n">cass</span><span class="p">,</span>
            <span class="n">cansr</span><span class="p">,</span>
            <span class="n">cajsr</span><span class="p">,</span>
            <span class="n">XS</span><span class="p">,</span>
            <span class="n">XW</span><span class="p">,</span>
            <span class="n">CaTrpn</span><span class="p">,</span>
            <span class="n">TmB</span><span class="p">,</span>
            <span class="n">Cd</span><span class="p">,</span>
            <span class="n">cai</span><span class="p">,</span>
            <span class="n">lmbda</span><span class="p">,</span>
            <span class="n">Zetas</span><span class="p">,</span>
            <span class="n">Zetaw</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">s</span>

        <span class="c1"># Assign parameters</span>
        <span class="n">scale_ICaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_ICaL&quot;</span><span class="p">]</span>
        <span class="n">scale_IK1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_IK1&quot;</span><span class="p">]</span>
        <span class="n">scale_IKr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_IKr&quot;</span><span class="p">]</span>
        <span class="n">scale_IKs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_IKs&quot;</span><span class="p">]</span>
        <span class="n">scale_INaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_INaL&quot;</span><span class="p">]</span>
        <span class="n">cao</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;cao&quot;</span><span class="p">]</span>
        <span class="n">ko</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;ko&quot;</span><span class="p">]</span>
        <span class="n">nao</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;nao&quot;</span><span class="p">]</span>
        <span class="n">F</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">]</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span>
        <span class="n">CaMKo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;CaMKo&quot;</span><span class="p">]</span>
        <span class="n">KmCaM</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;KmCaM&quot;</span><span class="p">]</span>
        <span class="n">KmCaMK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;KmCaMK&quot;</span><span class="p">]</span>
        <span class="n">PKNa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;PKNa&quot;</span><span class="p">]</span>
        <span class="n">Ahf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Ahf&quot;</span><span class="p">]</span>
        <span class="n">GNa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;GNa&quot;</span><span class="p">]</span>
        <span class="n">Gto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Gto&quot;</span><span class="p">]</span>
        <span class="n">Aff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Aff&quot;</span><span class="p">]</span>
        <span class="n">zca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;zca&quot;</span><span class="p">]</span>
        <span class="n">Gncx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Gncx&quot;</span><span class="p">]</span>
        <span class="n">KmCaAct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;KmCaAct&quot;</span><span class="p">]</span>
        <span class="n">kasymm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kasymm&quot;</span><span class="p">]</span>
        <span class="n">kcaoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kcaoff&quot;</span><span class="p">]</span>
        <span class="n">kcaon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kcaon&quot;</span><span class="p">]</span>
        <span class="n">kna1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kna1&quot;</span><span class="p">]</span>
        <span class="n">kna2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kna2&quot;</span><span class="p">]</span>
        <span class="n">kna3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kna3&quot;</span><span class="p">]</span>
        <span class="n">qca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;qca&quot;</span><span class="p">]</span>
        <span class="n">qna</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;qna&quot;</span><span class="p">]</span>
        <span class="n">wca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;wca&quot;</span><span class="p">]</span>
        <span class="n">wna</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;wna&quot;</span><span class="p">]</span>
        <span class="n">wnaca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;wnaca&quot;</span><span class="p">]</span>
        <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">]</span>
        <span class="n">Khp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Khp&quot;</span><span class="p">]</span>
        <span class="n">Kki</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kki&quot;</span><span class="p">]</span>
        <span class="n">Kko</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kko&quot;</span><span class="p">]</span>
        <span class="n">Kmgatp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kmgatp&quot;</span><span class="p">]</span>
        <span class="n">Knai0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Knai0&quot;</span><span class="p">]</span>
        <span class="n">Knao0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Knao0&quot;</span><span class="p">]</span>
        <span class="n">Knap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Knap&quot;</span><span class="p">]</span>
        <span class="n">Kxkur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kxkur&quot;</span><span class="p">]</span>
        <span class="n">MgADP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;MgADP&quot;</span><span class="p">]</span>
        <span class="n">MgATP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;MgATP&quot;</span><span class="p">]</span>
        <span class="n">Pnak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Pnak&quot;</span><span class="p">]</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span>
        <span class="n">eP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;eP&quot;</span><span class="p">]</span>
        <span class="n">k1m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k1m&quot;</span><span class="p">]</span>
        <span class="n">k1p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k1p&quot;</span><span class="p">]</span>
        <span class="n">k2m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k2m&quot;</span><span class="p">]</span>
        <span class="n">k2p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k2p&quot;</span><span class="p">]</span>
        <span class="n">k3m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k3m&quot;</span><span class="p">]</span>
        <span class="n">k3p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k3p&quot;</span><span class="p">]</span>
        <span class="n">k4m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k4m&quot;</span><span class="p">]</span>
        <span class="n">k4p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k4p&quot;</span><span class="p">]</span>
        <span class="n">zk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;zk&quot;</span><span class="p">]</span>
        <span class="n">GKb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;GKb&quot;</span><span class="p">]</span>
        <span class="n">PNab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;PNab&quot;</span><span class="p">]</span>
        <span class="n">PCab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;PCab&quot;</span><span class="p">]</span>
        <span class="n">GpCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;GpCa&quot;</span><span class="p">]</span>
        <span class="c1"># Drug factor</span>
        <span class="n">scale_drug_INa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_INa&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_INaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_INaL&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_Ito</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_Ito&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_ICaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_ICaL&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IKr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IKr&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IKs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IKs&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IK1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IK1&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IKb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IKb&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_INab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_INab&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_ICab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_ICab&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IpCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IpCa&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_Isacns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_Isacns&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_Isack</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_Isack&quot;</span><span class="p">]</span>
        <span class="c1"># Population factors</span>
        <span class="n">scale_popu_GNa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GNa&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GCaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GCaL&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_Gto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_Gto&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GNaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GNaL&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GKr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GKr&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GKs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GKs&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GK1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GK1&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GbK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GbK&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_KNCX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_KNCX&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_KNaK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_KNaK&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GbNa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GbNa&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GbCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GbCa&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_KpCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_KpCa&quot;</span><span class="p">]</span>
        <span class="c1"># Systolic Heart Failure (HF with preserved ejection fraction)</span>
        <span class="n">HF_scaling_CaMKa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_CaMKa&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_GNaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_GNaL&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_GK1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_GK1&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Gto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Gto&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Gncx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Gncx&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Pnak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Pnak&quot;</span><span class="p">]</span>

        <span class="c1"># Init return args</span>
        <span class="n">current</span> <span class="o">=</span> <span class="p">[</span><span class="n">ufl</span><span class="o">.</span><span class="n">zero</span><span class="p">()]</span> <span class="o">*</span> <span class="mi">1</span>

        <span class="c1"># Expressions for the CaMKt component</span>
        <span class="n">CaMKb</span> <span class="o">=</span> <span class="n">CaMKo</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">CaMKt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaM</span> <span class="o">/</span> <span class="n">cass</span><span class="p">)</span>
        <span class="n">CaMKa</span> <span class="o">=</span> <span class="p">(</span><span class="n">CaMKb</span> <span class="o">+</span> <span class="n">CaMKt</span><span class="p">)</span> <span class="o">*</span> <span class="n">HF_scaling_CaMKa</span>

        <span class="c1"># Expressions for the reversal potentials component</span>
        <span class="n">ENa</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">nao</span> <span class="o">/</span> <span class="n">nai</span><span class="p">)</span> <span class="o">/</span> <span class="n">F</span>
        <span class="n">EK</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">ko</span> <span class="o">/</span> <span class="n">ki</span><span class="p">)</span> <span class="o">/</span> <span class="n">F</span>
        <span class="n">EKs</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">ln</span><span class="p">((</span><span class="n">ko</span> <span class="o">+</span> <span class="n">PKNa</span> <span class="o">*</span> <span class="n">nao</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">PKNa</span> <span class="o">*</span> <span class="n">nai</span> <span class="o">+</span> <span class="n">ki</span><span class="p">))</span> <span class="o">/</span> <span class="n">F</span>
        <span class="n">vffrt</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">F</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
        <span class="n">vfrt</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>

        <span class="c1"># Expressions for the I_Na component</span>
        <span class="n">Ahs</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">Ahf</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">Ahf</span> <span class="o">*</span> <span class="n">hf</span> <span class="o">+</span> <span class="n">Ahs</span> <span class="o">*</span> <span class="n">hs</span>
        <span class="n">hp</span> <span class="o">=</span> <span class="n">Ahf</span> <span class="o">*</span> <span class="n">hf</span> <span class="o">+</span> <span class="n">Ahs</span> <span class="o">*</span> <span class="n">hsp</span>
        <span class="n">fINap</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">INa</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">GNa</span>
            <span class="o">*</span> <span class="n">scale_drug_INa</span>
            <span class="o">*</span> <span class="n">scale_popu_GNa</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">ENa</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fINap</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="n">fINap</span> <span class="o">*</span> <span class="n">hp</span> <span class="o">*</span> <span class="n">jp</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the INaL component</span>
        <span class="n">GNaL</span> <span class="o">=</span> <span class="mf">0.0075</span> <span class="o">*</span> <span class="n">scale_INaL</span> <span class="o">*</span> <span class="n">scale_drug_INaL</span> <span class="o">*</span> <span class="n">scale_popu_GNaL</span> <span class="o">*</span> <span class="n">HF_scaling_GNaL</span>
        <span class="n">fINaLp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">INaL</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ENa</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fINaLp</span><span class="p">)</span> <span class="o">*</span> <span class="n">hL</span> <span class="o">+</span> <span class="n">fINaLp</span> <span class="o">*</span> <span class="n">hLp</span><span class="p">)</span> <span class="o">*</span> <span class="n">GNaL</span> <span class="o">*</span> <span class="n">mL</span>

        <span class="c1"># Expressions for the Ito component</span>
        <span class="n">AiF</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.24348537187522867</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.006613756613756614</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">AiS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">AiF</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">AiF</span> <span class="o">*</span> <span class="n">iF</span> <span class="o">+</span> <span class="n">AiS</span> <span class="o">*</span> <span class="n">iS</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">AiF</span> <span class="o">*</span> <span class="n">iFp</span> <span class="o">+</span> <span class="n">AiS</span> <span class="o">*</span> <span class="n">iSp</span>
        <span class="n">fItop</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">Ito</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Gto</span>
            <span class="o">*</span> <span class="n">scale_drug_Ito</span>
            <span class="o">*</span> <span class="n">scale_popu_Gto</span>
            <span class="o">*</span> <span class="n">HF_scaling_Gto</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EK</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fItop</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">ap</span> <span class="o">*</span> <span class="n">fItop</span> <span class="o">*</span> <span class="n">ip</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the ICaL ICaNa ICaK component</span>
        <span class="n">Afs</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">Aff</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">Aff</span> <span class="o">*</span> <span class="n">ff</span> <span class="o">+</span> <span class="n">Afs</span> <span class="o">*</span> <span class="n">fs</span>
        <span class="n">Afcaf</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.36787944117144233</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">Afcas</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">Afcaf</span>
        <span class="n">fca</span> <span class="o">=</span> <span class="n">Afcaf</span> <span class="o">*</span> <span class="n">fcaf</span> <span class="o">+</span> <span class="n">Afcas</span> <span class="o">*</span> <span class="n">fcas</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">Aff</span> <span class="o">*</span> <span class="n">ffp</span> <span class="o">+</span> <span class="n">Afs</span> <span class="o">*</span> <span class="n">fs</span>
        <span class="n">fcap</span> <span class="o">=</span> <span class="n">Afcaf</span> <span class="o">*</span> <span class="n">fcafp</span> <span class="o">+</span> <span class="n">Afcas</span> <span class="o">*</span> <span class="n">fcas</span>
        <span class="n">PhiCaL</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">4.0</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.341</span> <span class="o">*</span> <span class="n">cao</span> <span class="o">+</span> <span class="n">cass</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">PhiCaNa</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">1.0</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">nao</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">)</span> <span class="o">*</span> <span class="n">nass</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">PhiCaK</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">1.0</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">ko</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">)</span> <span class="o">*</span> <span class="n">kss</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">PCa</span> <span class="o">=</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">scale_ICaL</span> <span class="o">*</span> <span class="n">scale_drug_ICaL</span> <span class="o">*</span> <span class="n">scale_popu_GCaL</span>
        <span class="n">PCap</span> <span class="o">=</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">PCa</span>
        <span class="n">PCaNa</span> <span class="o">=</span> <span class="mf">0.00125</span> <span class="o">*</span> <span class="n">PCa</span>
        <span class="n">PCaK</span> <span class="o">=</span> <span class="mf">0.0003574</span> <span class="o">*</span> <span class="n">PCa</span>
        <span class="n">PCaNap</span> <span class="o">=</span> <span class="mf">0.00125</span> <span class="o">*</span> <span class="n">PCap</span>
        <span class="n">PCaKp</span> <span class="o">=</span> <span class="mf">0.0003574</span> <span class="o">*</span> <span class="n">PCap</span>
        <span class="n">fICaLp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">ICaL</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fICaLp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span> <span class="o">+</span> <span class="n">fca</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCa</span> <span class="o">*</span> <span class="n">PhiCaL</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">fp</span> <span class="o">+</span> <span class="n">fcap</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCap</span> <span class="o">*</span> <span class="n">PhiCaL</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">fICaLp</span>
        <span class="n">ICaNa</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fICaLp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span> <span class="o">+</span> <span class="n">fca</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCaNa</span> <span class="o">*</span> <span class="n">PhiCaNa</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">fp</span> <span class="o">+</span> <span class="n">fcap</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCaNap</span> <span class="o">*</span> <span class="n">PhiCaNa</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">fICaLp</span>
        <span class="n">ICaK</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fICaLp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span> <span class="o">+</span> <span class="n">fca</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCaK</span> <span class="o">*</span> <span class="n">PhiCaK</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">fp</span> <span class="o">+</span> <span class="n">fcap</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCaKp</span> <span class="o">*</span> <span class="n">PhiCaK</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">fICaLp</span>

        <span class="c1"># Expressions for the IKr component</span>
        <span class="n">Axrf</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">4.197299094734718</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.02617115938236064</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">Axrs</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">Axrf</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">Axrf</span> <span class="o">*</span> <span class="n">xrf</span> <span class="o">+</span> <span class="n">Axrs</span> <span class="o">*</span> <span class="n">xrs</span>
        <span class="n">rkr</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.0820090840784555</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.013333333333333334</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.7165313105737893</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.03333333333333333</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">GKr</span> <span class="o">=</span> <span class="mf">0.046</span> <span class="o">*</span> <span class="n">scale_IKr</span> <span class="o">*</span> <span class="n">scale_drug_IKr</span> <span class="o">*</span> <span class="n">scale_popu_GKr</span>
        <span class="n">IKr</span> <span class="o">=</span> <span class="mf">0.4303314829119352</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ko</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EK</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">GKr</span> <span class="o">*</span> <span class="n">rkr</span> <span class="o">*</span> <span class="n">xr</span>

        <span class="c1"># Expressions for the IKs component</span>
        <span class="n">KsCa</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">6.481821026062645e-07</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">cai</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">))</span>
        <span class="n">GKs</span> <span class="o">=</span> <span class="mf">0.0034</span> <span class="o">*</span> <span class="n">scale_IKs</span> <span class="o">*</span> <span class="n">scale_drug_IKs</span> <span class="o">*</span> <span class="n">scale_popu_GKs</span>
        <span class="n">IKs</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">EKs</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">GKs</span> <span class="o">*</span> <span class="n">KsCa</span> <span class="o">*</span> <span class="n">xs1</span> <span class="o">*</span> <span class="n">xs2</span>
        <span class="n">rk1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">1.0</span>
            <span class="o">+</span> <span class="mf">69220.6322106767</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.10534077741493732</span> <span class="o">*</span> <span class="n">v</span> <span class="o">-</span> <span class="mf">0.27388602127883704</span> <span class="o">*</span> <span class="n">ko</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">GK1</span> <span class="o">=</span> <span class="mf">0.1908</span> <span class="o">*</span> <span class="n">scale_IK1</span> <span class="o">*</span> <span class="n">scale_drug_IK1</span> <span class="o">*</span> <span class="n">scale_popu_GK1</span> <span class="o">*</span> <span class="n">HF_scaling_GK1</span>
        <span class="n">IK1</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ko</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EK</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">GK1</span> <span class="o">*</span> <span class="n">rk1</span> <span class="o">*</span> <span class="n">xk1</span>

        <span class="c1"># Expressions for the INaCa_i component</span>
        <span class="n">hca</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">qca</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">hna</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">qna</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">h1_i</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">hna</span><span class="p">)</span> <span class="o">*</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">kna3</span>
        <span class="n">h2_i</span> <span class="o">=</span> <span class="n">hna</span> <span class="o">*</span> <span class="n">nai</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna3</span> <span class="o">*</span> <span class="n">h1_i</span><span class="p">)</span>
        <span class="n">h3_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h1_i</span>
        <span class="n">h4_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">kna2</span><span class="p">)</span> <span class="o">*</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">kna1</span>
        <span class="n">h5_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">nai</span> <span class="o">*</span> <span class="n">nai</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna1</span> <span class="o">*</span> <span class="n">kna2</span> <span class="o">*</span> <span class="n">h4_i</span><span class="p">)</span>
        <span class="n">h6_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h4_i</span>
        <span class="n">h7_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">hna</span><span class="p">)</span> <span class="o">/</span> <span class="n">kna3</span>
        <span class="n">h8_i</span> <span class="o">=</span> <span class="n">nao</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna3</span> <span class="o">*</span> <span class="n">h7_i</span> <span class="o">*</span> <span class="n">hna</span><span class="p">)</span>
        <span class="n">h9_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h7_i</span>
        <span class="n">h10_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">kasymm</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">/</span> <span class="n">kna2</span><span class="p">)</span> <span class="o">/</span> <span class="n">kna1</span>
        <span class="n">h11_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">nao</span> <span class="o">*</span> <span class="n">nao</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna1</span> <span class="o">*</span> <span class="n">kna2</span> <span class="o">*</span> <span class="n">h10_i</span><span class="p">)</span>
        <span class="n">h12_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h10_i</span>
        <span class="n">k1_i</span> <span class="o">=</span> <span class="n">cao</span> <span class="o">*</span> <span class="n">kcaon</span> <span class="o">*</span> <span class="n">h12_i</span>
        <span class="n">k2_i</span> <span class="o">=</span> <span class="n">kcaoff</span>
        <span class="n">k3p_i</span> <span class="o">=</span> <span class="n">wca</span> <span class="o">*</span> <span class="n">h9_i</span>
        <span class="n">k3pp_i</span> <span class="o">=</span> <span class="n">wnaca</span> <span class="o">*</span> <span class="n">h8_i</span>
        <span class="n">k3_i</span> <span class="o">=</span> <span class="n">k3p_i</span> <span class="o">+</span> <span class="n">k3pp_i</span>
        <span class="n">k4p_i</span> <span class="o">=</span> <span class="n">wca</span> <span class="o">*</span> <span class="n">h3_i</span> <span class="o">/</span> <span class="n">hca</span>
        <span class="n">k4pp_i</span> <span class="o">=</span> <span class="n">wnaca</span> <span class="o">*</span> <span class="n">h2_i</span>
        <span class="n">k4_i</span> <span class="o">=</span> <span class="n">k4p_i</span> <span class="o">+</span> <span class="n">k4pp_i</span>
        <span class="n">k5_i</span> <span class="o">=</span> <span class="n">kcaoff</span>
        <span class="n">k6_i</span> <span class="o">=</span> <span class="n">kcaon</span> <span class="o">*</span> <span class="n">cai</span> <span class="o">*</span> <span class="n">h6_i</span>
        <span class="n">k7_i</span> <span class="o">=</span> <span class="n">wna</span> <span class="o">*</span> <span class="n">h2_i</span> <span class="o">*</span> <span class="n">h5_i</span>
        <span class="n">k8_i</span> <span class="o">=</span> <span class="n">wna</span> <span class="o">*</span> <span class="n">h11_i</span> <span class="o">*</span> <span class="n">h8_i</span>
        <span class="n">x1_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2_i</span> <span class="o">+</span> <span class="n">k3_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k5_i</span> <span class="o">*</span> <span class="n">k7_i</span> <span class="o">+</span> <span class="p">(</span><span class="n">k6_i</span> <span class="o">+</span> <span class="n">k7_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2_i</span> <span class="o">*</span> <span class="n">k4_i</span>
        <span class="n">x2_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1_i</span> <span class="o">+</span> <span class="n">k8_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k4_i</span> <span class="o">*</span> <span class="n">k6_i</span> <span class="o">+</span> <span class="p">(</span><span class="n">k4_i</span> <span class="o">+</span> <span class="n">k5_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k1_i</span> <span class="o">*</span> <span class="n">k7_i</span>
        <span class="n">x3_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2_i</span> <span class="o">+</span> <span class="n">k3_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k6_i</span> <span class="o">*</span> <span class="n">k8_i</span> <span class="o">+</span> <span class="p">(</span><span class="n">k6_i</span> <span class="o">+</span> <span class="n">k7_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k1_i</span> <span class="o">*</span> <span class="n">k3_i</span>
        <span class="n">x4_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1_i</span> <span class="o">+</span> <span class="n">k8_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k3_i</span> <span class="o">*</span> <span class="n">k5_i</span> <span class="o">+</span> <span class="p">(</span><span class="n">k4_i</span> <span class="o">+</span> <span class="n">k5_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2_i</span> <span class="o">*</span> <span class="n">k8_i</span>
        <span class="n">E1_i</span> <span class="o">=</span> <span class="n">x1_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_i</span> <span class="o">+</span> <span class="n">x2_i</span> <span class="o">+</span> <span class="n">x3_i</span> <span class="o">+</span> <span class="n">x4_i</span><span class="p">)</span>
        <span class="n">E2_i</span> <span class="o">=</span> <span class="n">x2_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_i</span> <span class="o">+</span> <span class="n">x2_i</span> <span class="o">+</span> <span class="n">x3_i</span> <span class="o">+</span> <span class="n">x4_i</span><span class="p">)</span>
        <span class="n">E3_i</span> <span class="o">=</span> <span class="n">x3_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_i</span> <span class="o">+</span> <span class="n">x2_i</span> <span class="o">+</span> <span class="n">x3_i</span> <span class="o">+</span> <span class="n">x4_i</span><span class="p">)</span>
        <span class="n">E4_i</span> <span class="o">=</span> <span class="n">x4_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_i</span> <span class="o">+</span> <span class="n">x2_i</span> <span class="o">+</span> <span class="n">x3_i</span> <span class="o">+</span> <span class="n">x4_i</span><span class="p">)</span>
        <span class="n">allo_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">KmCaAct</span> <span class="o">/</span> <span class="n">cai</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
        <span class="n">zna</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">JncxNa_i</span> <span class="o">=</span> <span class="n">E3_i</span> <span class="o">*</span> <span class="n">k4pp_i</span> <span class="o">-</span> <span class="n">E2_i</span> <span class="o">*</span> <span class="n">k3pp_i</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E4_i</span> <span class="o">*</span> <span class="n">k7_i</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E1_i</span> <span class="o">*</span> <span class="n">k8_i</span>
        <span class="n">JncxCa_i</span> <span class="o">=</span> <span class="n">E2_i</span> <span class="o">*</span> <span class="n">k2_i</span> <span class="o">-</span> <span class="n">E1_i</span> <span class="o">*</span> <span class="n">k1_i</span>
        <span class="n">INaCa_i</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">0.8</span>
            <span class="o">*</span> <span class="n">Gncx</span>
            <span class="o">*</span> <span class="n">scale_popu_KNCX</span>
            <span class="o">*</span> <span class="n">HF_scaling_Gncx</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">zca</span> <span class="o">*</span> <span class="n">JncxCa_i</span> <span class="o">+</span> <span class="n">zna</span> <span class="o">*</span> <span class="n">JncxNa_i</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">allo_i</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the INaCa_ss component</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">hna</span><span class="p">)</span> <span class="o">*</span> <span class="n">nass</span> <span class="o">/</span> <span class="n">kna3</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">hna</span> <span class="o">*</span> <span class="n">nass</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna3</span> <span class="o">*</span> <span class="n">h1</span><span class="p">)</span>
        <span class="n">h3</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h1</span>
        <span class="n">h4</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nass</span> <span class="o">/</span> <span class="n">kna2</span><span class="p">)</span> <span class="o">*</span> <span class="n">nass</span> <span class="o">/</span> <span class="n">kna1</span>
        <span class="n">h5</span> <span class="o">=</span> <span class="p">(</span><span class="n">nass</span> <span class="o">*</span> <span class="n">nass</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna1</span> <span class="o">*</span> <span class="n">kna2</span> <span class="o">*</span> <span class="n">h4</span><span class="p">)</span>
        <span class="n">h6</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h4</span>
        <span class="n">h7</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">hna</span><span class="p">)</span> <span class="o">/</span> <span class="n">kna3</span>
        <span class="n">h8</span> <span class="o">=</span> <span class="n">nao</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna3</span> <span class="o">*</span> <span class="n">h7</span> <span class="o">*</span> <span class="n">hna</span><span class="p">)</span>
        <span class="n">h9</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h7</span>
        <span class="n">h10</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">kasymm</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">/</span> <span class="n">kna2</span><span class="p">)</span> <span class="o">/</span> <span class="n">kna1</span>
        <span class="n">h11</span> <span class="o">=</span> <span class="p">(</span><span class="n">nao</span> <span class="o">*</span> <span class="n">nao</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna1</span> <span class="o">*</span> <span class="n">kna2</span> <span class="o">*</span> <span class="n">h10</span><span class="p">)</span>
        <span class="n">h12</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h10</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">cao</span> <span class="o">*</span> <span class="n">kcaon</span> <span class="o">*</span> <span class="n">h12</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="n">kcaoff</span>
        <span class="n">k3p_ss</span> <span class="o">=</span> <span class="n">wca</span> <span class="o">*</span> <span class="n">h9</span>
        <span class="n">k3pp</span> <span class="o">=</span> <span class="n">wnaca</span> <span class="o">*</span> <span class="n">h8</span>
        <span class="n">k3</span> <span class="o">=</span> <span class="n">k3p_ss</span> <span class="o">+</span> <span class="n">k3pp</span>
        <span class="n">k4p_ss</span> <span class="o">=</span> <span class="n">wca</span> <span class="o">*</span> <span class="n">h3</span> <span class="o">/</span> <span class="n">hca</span>
        <span class="n">k4pp</span> <span class="o">=</span> <span class="n">wnaca</span> <span class="o">*</span> <span class="n">h2</span>
        <span class="n">k4</span> <span class="o">=</span> <span class="n">k4p_ss</span> <span class="o">+</span> <span class="n">k4pp</span>
        <span class="n">k5</span> <span class="o">=</span> <span class="n">kcaoff</span>
        <span class="n">k6</span> <span class="o">=</span> <span class="n">kcaon</span> <span class="o">*</span> <span class="n">cass</span> <span class="o">*</span> <span class="n">h6</span>
        <span class="n">k7</span> <span class="o">=</span> <span class="n">wna</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">*</span> <span class="n">h5</span>
        <span class="n">k8</span> <span class="o">=</span> <span class="n">wna</span> <span class="o">*</span> <span class="n">h11</span> <span class="o">*</span> <span class="n">h8</span>
        <span class="n">x1_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">*</span> <span class="n">k5</span> <span class="o">*</span> <span class="n">k7</span> <span class="o">+</span> <span class="p">(</span><span class="n">k6</span> <span class="o">+</span> <span class="n">k7</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">*</span> <span class="n">k4</span>
        <span class="n">x2_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="n">k8</span><span class="p">)</span> <span class="o">*</span> <span class="n">k4</span> <span class="o">*</span> <span class="n">k6</span> <span class="o">+</span> <span class="p">(</span><span class="n">k4</span> <span class="o">+</span> <span class="n">k5</span><span class="p">)</span> <span class="o">*</span> <span class="n">k1</span> <span class="o">*</span> <span class="n">k7</span>
        <span class="n">x3_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">*</span> <span class="n">k6</span> <span class="o">*</span> <span class="n">k8</span> <span class="o">+</span> <span class="p">(</span><span class="n">k6</span> <span class="o">+</span> <span class="n">k7</span><span class="p">)</span> <span class="o">*</span> <span class="n">k1</span> <span class="o">*</span> <span class="n">k3</span>
        <span class="n">x4_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="n">k8</span><span class="p">)</span> <span class="o">*</span> <span class="n">k3</span> <span class="o">*</span> <span class="n">k5</span> <span class="o">+</span> <span class="p">(</span><span class="n">k4</span> <span class="o">+</span> <span class="n">k5</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">*</span> <span class="n">k8</span>
        <span class="n">E1_ss</span> <span class="o">=</span> <span class="n">x1_ss</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_ss</span> <span class="o">+</span> <span class="n">x2_ss</span> <span class="o">+</span> <span class="n">x3_ss</span> <span class="o">+</span> <span class="n">x4_ss</span><span class="p">)</span>
        <span class="n">E2_ss</span> <span class="o">=</span> <span class="n">x2_ss</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_ss</span> <span class="o">+</span> <span class="n">x2_ss</span> <span class="o">+</span> <span class="n">x3_ss</span> <span class="o">+</span> <span class="n">x4_ss</span><span class="p">)</span>
        <span class="n">E3_ss</span> <span class="o">=</span> <span class="n">x3_ss</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_ss</span> <span class="o">+</span> <span class="n">x2_ss</span> <span class="o">+</span> <span class="n">x3_ss</span> <span class="o">+</span> <span class="n">x4_ss</span><span class="p">)</span>
        <span class="n">E4_ss</span> <span class="o">=</span> <span class="n">x4_ss</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_ss</span> <span class="o">+</span> <span class="n">x2_ss</span> <span class="o">+</span> <span class="n">x3_ss</span> <span class="o">+</span> <span class="n">x4_ss</span><span class="p">)</span>
        <span class="n">allo_ss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">KmCaAct</span> <span class="o">/</span> <span class="n">cass</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
        <span class="n">JncxNa_ss</span> <span class="o">=</span> <span class="n">E3_ss</span> <span class="o">*</span> <span class="n">k4pp</span> <span class="o">-</span> <span class="n">E2_ss</span> <span class="o">*</span> <span class="n">k3pp</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E4_ss</span> <span class="o">*</span> <span class="n">k7</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E1_ss</span> <span class="o">*</span> <span class="n">k8</span>
        <span class="n">JncxCa_ss</span> <span class="o">=</span> <span class="n">E2_ss</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">-</span> <span class="n">E1_ss</span> <span class="o">*</span> <span class="n">k1</span>
        <span class="n">INaCa_ss</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">0.2</span>
            <span class="o">*</span> <span class="n">Gncx</span>
            <span class="o">*</span> <span class="n">scale_popu_KNCX</span>
            <span class="o">*</span> <span class="n">HF_scaling_Gncx</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">zca</span> <span class="o">*</span> <span class="n">JncxCa_ss</span> <span class="o">+</span> <span class="n">zna</span> <span class="o">*</span> <span class="n">JncxNa_ss</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">allo_ss</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the INaK component</span>
        <span class="n">Knai</span> <span class="o">=</span> <span class="n">Knai0</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3333333333333333</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">Knao</span> <span class="o">=</span> <span class="n">Knao0</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3333333333333333</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">eP</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">H</span> <span class="o">/</span> <span class="n">Khp</span> <span class="o">+</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">Knap</span> <span class="o">+</span> <span class="n">ki</span> <span class="o">/</span> <span class="n">Kxkur</span><span class="p">)</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">k1p</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">nai</span> <span class="o">/</span> <span class="n">Knai</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="o">-</span><span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ki</span> <span class="o">/</span> <span class="n">Kki</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">Knai</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">MgADP</span> <span class="o">*</span> <span class="n">k1m</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">k2p</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">k2m</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">nao</span> <span class="o">/</span> <span class="n">Knao</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="o">-</span><span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ko</span> <span class="o">/</span> <span class="n">Kko</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">/</span> <span class="n">Knao</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">a3</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">k3p</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">ko</span> <span class="o">/</span> <span class="n">Kko</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="o">-</span><span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ko</span> <span class="o">/</span> <span class="n">Kko</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">/</span> <span class="n">Knao</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">b3</span> <span class="o">=</span> <span class="n">H</span> <span class="o">*</span> <span class="n">k3m</span> <span class="o">*</span> <span class="n">P</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">MgATP</span> <span class="o">/</span> <span class="n">Kmgatp</span><span class="p">)</span>
        <span class="n">a4</span> <span class="o">=</span> <span class="n">MgATP</span> <span class="o">*</span> <span class="n">k4p</span> <span class="o">/</span> <span class="p">(</span><span class="n">Kmgatp</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">MgATP</span> <span class="o">/</span> <span class="n">Kmgatp</span><span class="p">))</span>
        <span class="n">b4</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">k4m</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">ki</span> <span class="o">/</span> <span class="n">Kki</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="o">-</span><span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ki</span> <span class="o">/</span> <span class="n">Kki</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">Knai</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">+</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">b4</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">b4</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b4</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b4</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b4</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">a4</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b3</span>
        <span class="n">x4</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">+</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">+</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">b4</span>
        <span class="n">E1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">E2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">E3</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">E4</span> <span class="o">=</span> <span class="n">x4</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">JnakNa</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E1</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E2</span> <span class="o">*</span> <span class="n">b3</span>
        <span class="n">JnakK</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">E4</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">E3</span> <span class="o">*</span> <span class="n">a1</span>
        <span class="n">INaK</span> <span class="o">=</span> <span class="n">Pnak</span> <span class="o">*</span> <span class="n">scale_popu_KNaK</span> <span class="o">*</span> <span class="n">HF_scaling_Pnak</span> <span class="o">*</span> <span class="p">(</span><span class="n">zk</span> <span class="o">*</span> <span class="n">JnakK</span> <span class="o">+</span> <span class="n">zna</span> <span class="o">*</span> <span class="n">JnakNa</span><span class="p">)</span>

        <span class="c1"># Expressions for the IKb component</span>
        <span class="n">xkb</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.202363450949239</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05452562704471101</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">IKb</span> <span class="o">=</span> <span class="n">GKb</span> <span class="o">*</span> <span class="n">scale_popu_GbK</span> <span class="o">*</span> <span class="n">scale_drug_IKb</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EK</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">xkb</span>

        <span class="c1"># Expressions for the INab component</span>
        <span class="n">INab</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">PNab</span>
            <span class="o">*</span> <span class="n">scale_drug_INab</span>
            <span class="o">*</span> <span class="n">scale_popu_GbNa</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">nao</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">vfrt</span><span class="p">)</span> <span class="o">*</span> <span class="n">nai</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the ICab component</span>
        <span class="n">ICab</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">4.0</span>
            <span class="o">*</span> <span class="n">PCab</span>
            <span class="o">*</span> <span class="n">scale_drug_ICab</span>
            <span class="o">*</span> <span class="n">scale_popu_GbCa</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.341</span> <span class="o">*</span> <span class="n">cao</span> <span class="o">+</span> <span class="n">cai</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the IpCa component</span>
        <span class="n">IpCa</span> <span class="o">=</span> <span class="n">GpCa</span> <span class="o">*</span> <span class="n">scale_drug_IpCa</span> <span class="o">*</span> <span class="n">scale_popu_KpCa</span> <span class="o">*</span> <span class="n">cai</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.0005</span> <span class="o">+</span> <span class="n">cai</span><span class="p">)</span>

        <span class="c1"># Expressions for the Isac (Pueyo)--&gt; ns + k component</span>
        <span class="n">Gsac_ns</span> <span class="o">=</span> <span class="mf">0.006</span> <span class="o">*</span> <span class="n">scale_drug_Isacns</span>
        <span class="n">Esac_ns</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span>
        <span class="n">lambda_max</span> <span class="o">=</span> <span class="mf">1.1</span>
        <span class="n">Gsac_k</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.2882</span> <span class="o">*</span> <span class="mf">800.0</span> <span class="o">/</span> <span class="mf">210.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale_drug_Isack</span>  <span class="c1"># Pueyo endo</span>

        <span class="n">Isac_P_ns</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span>
            <span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">lmbda</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="mf">0.0</span><span class="p">,</span>
            <span class="n">Gsac_ns</span> <span class="o">*</span> <span class="p">((</span><span class="n">lmbda</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">lambda_max</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">Esac_ns</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">Isac_P_k</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span>
            <span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">lmbda</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="mf">0.0</span><span class="p">,</span>
            <span class="n">Gsac_k</span>
            <span class="o">*</span> <span class="p">((</span><span class="n">lmbda</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">lambda_max</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="mf">19.05</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">29.98</span><span class="p">)))),</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the Istim component</span>
        <span class="n">Istim</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># amp*(ufl.le(time, duration))</span>

        <span class="c1"># Expressions for the membrane potential component</span>
        <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">Isac_P_k</span>
            <span class="o">-</span> <span class="n">Isac_P_ns</span>
            <span class="o">-</span> <span class="n">ICaK</span>
            <span class="o">-</span> <span class="n">ICaL</span>
            <span class="o">-</span> <span class="n">ICaNa</span>
            <span class="o">-</span> <span class="n">ICab</span>
            <span class="o">-</span> <span class="n">IK1</span>
            <span class="o">-</span> <span class="n">IKb</span>
            <span class="o">-</span> <span class="n">IKr</span>
            <span class="o">-</span> <span class="n">IKs</span>
            <span class="o">-</span> <span class="n">INa</span>
            <span class="o">-</span> <span class="n">INaCa_i</span>
            <span class="o">-</span> <span class="n">INaCa_ss</span>
            <span class="o">-</span> <span class="n">INaK</span>
            <span class="o">-</span> <span class="n">INaL</span>
            <span class="o">-</span> <span class="n">INab</span>
            <span class="o">-</span> <span class="n">IpCa</span>
            <span class="o">-</span> <span class="n">Istim</span>
            <span class="o">-</span> <span class="n">Ito</span>
        <span class="p">)</span>

        <span class="c1"># Return results</span>
        <span class="k">return</span> <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="ORdmm_Land.I"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.ORdmm_Land.I">[docs]</a>    <span class="k">def</span> <span class="nf">I</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># noqa: E741, E743</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transmembrane current</span>

<span class="sd">           I = -dV/dt</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_I</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></div>

<div class="viewcode-block" id="ORdmm_Land.F"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.ORdmm_Land.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Right hand side for ODE system</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="k">if</span> <span class="n">time</span> <span class="k">else</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># Assign states</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">48</span>
        <span class="p">(</span>
            <span class="n">CaMKt</span><span class="p">,</span>
            <span class="n">m</span><span class="p">,</span>
            <span class="n">hf</span><span class="p">,</span>
            <span class="n">hs</span><span class="p">,</span>
            <span class="n">j</span><span class="p">,</span>
            <span class="n">hsp</span><span class="p">,</span>
            <span class="n">jp</span><span class="p">,</span>
            <span class="n">mL</span><span class="p">,</span>
            <span class="n">hL</span><span class="p">,</span>
            <span class="n">hLp</span><span class="p">,</span>
            <span class="n">a</span><span class="p">,</span>
            <span class="n">iF</span><span class="p">,</span>
            <span class="n">iS</span><span class="p">,</span>
            <span class="n">ap</span><span class="p">,</span>
            <span class="n">iFp</span><span class="p">,</span>
            <span class="n">iSp</span><span class="p">,</span>
            <span class="n">d</span><span class="p">,</span>
            <span class="n">ff</span><span class="p">,</span>
            <span class="n">fs</span><span class="p">,</span>
            <span class="n">fcaf</span><span class="p">,</span>
            <span class="n">fcas</span><span class="p">,</span>
            <span class="n">jca</span><span class="p">,</span>
            <span class="n">ffp</span><span class="p">,</span>
            <span class="n">fcafp</span><span class="p">,</span>
            <span class="n">nca</span><span class="p">,</span>
            <span class="n">xrf</span><span class="p">,</span>
            <span class="n">xrs</span><span class="p">,</span>
            <span class="n">xs1</span><span class="p">,</span>
            <span class="n">xs2</span><span class="p">,</span>
            <span class="n">xk1</span><span class="p">,</span>
            <span class="n">Jrelnp</span><span class="p">,</span>
            <span class="n">Jrelp</span><span class="p">,</span>
            <span class="n">nai</span><span class="p">,</span>
            <span class="n">nass</span><span class="p">,</span>
            <span class="n">ki</span><span class="p">,</span>
            <span class="n">kss</span><span class="p">,</span>
            <span class="n">cass</span><span class="p">,</span>
            <span class="n">cansr</span><span class="p">,</span>
            <span class="n">cajsr</span><span class="p">,</span>
            <span class="n">XS</span><span class="p">,</span>
            <span class="n">XW</span><span class="p">,</span>
            <span class="n">CaTrpn</span><span class="p">,</span>
            <span class="n">TmB</span><span class="p">,</span>
            <span class="n">Cd</span><span class="p">,</span>
            <span class="n">cai</span><span class="p">,</span>
            <span class="n">lmbda</span><span class="p">,</span>
            <span class="n">Zetas</span><span class="p">,</span>
            <span class="n">Zetaw</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">s</span>

        <span class="c1"># Assign parameters</span>
        <span class="n">scale_ICaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_ICaL&quot;</span><span class="p">]</span>
        <span class="n">scale_IK1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_IK1&quot;</span><span class="p">]</span>
        <span class="n">scale_IKr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_IKr&quot;</span><span class="p">]</span>
        <span class="n">scale_IKs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_IKs&quot;</span><span class="p">]</span>
        <span class="n">scale_INaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_INaL&quot;</span><span class="p">]</span>
        <span class="n">cao</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;cao&quot;</span><span class="p">]</span>
        <span class="n">ko</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;ko&quot;</span><span class="p">]</span>
        <span class="n">nao</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;nao&quot;</span><span class="p">]</span>
        <span class="n">F</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">]</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span>
        <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span>
        <span class="n">rad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;rad&quot;</span><span class="p">]</span>
        <span class="n">CaMKo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;CaMKo&quot;</span><span class="p">]</span>
        <span class="n">KmCaM</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;KmCaM&quot;</span><span class="p">]</span>
        <span class="n">KmCaMK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;KmCaMK&quot;</span><span class="p">]</span>
        <span class="n">aCaMK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;aCaMK&quot;</span><span class="p">]</span>
        <span class="n">bCaMK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;bCaMK&quot;</span><span class="p">]</span>
        <span class="n">PKNa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;PKNa&quot;</span><span class="p">]</span>
        <span class="n">Ahf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Ahf&quot;</span><span class="p">]</span>
        <span class="n">GNa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;GNa&quot;</span><span class="p">]</span>
        <span class="n">thL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;thL&quot;</span><span class="p">]</span>
        <span class="n">Gto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Gto&quot;</span><span class="p">]</span>
        <span class="n">delta_epi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;delta_epi&quot;</span><span class="p">]</span>
        <span class="n">Aff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Aff&quot;</span><span class="p">]</span>
        <span class="n">Kmn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kmn&quot;</span><span class="p">]</span>
        <span class="n">k2n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k2n&quot;</span><span class="p">]</span>
        <span class="n">tjca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;tjca&quot;</span><span class="p">]</span>
        <span class="n">zca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;zca&quot;</span><span class="p">]</span>
        <span class="n">Gncx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Gncx&quot;</span><span class="p">]</span>
        <span class="n">KmCaAct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;KmCaAct&quot;</span><span class="p">]</span>
        <span class="n">kasymm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kasymm&quot;</span><span class="p">]</span>
        <span class="n">kcaoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kcaoff&quot;</span><span class="p">]</span>
        <span class="n">kcaon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kcaon&quot;</span><span class="p">]</span>
        <span class="n">kna1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kna1&quot;</span><span class="p">]</span>
        <span class="n">kna2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kna2&quot;</span><span class="p">]</span>
        <span class="n">kna3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kna3&quot;</span><span class="p">]</span>
        <span class="n">qca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;qca&quot;</span><span class="p">]</span>
        <span class="n">qna</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;qna&quot;</span><span class="p">]</span>
        <span class="n">wca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;wca&quot;</span><span class="p">]</span>
        <span class="n">wna</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;wna&quot;</span><span class="p">]</span>
        <span class="n">wnaca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;wnaca&quot;</span><span class="p">]</span>
        <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">]</span>
        <span class="n">Khp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Khp&quot;</span><span class="p">]</span>
        <span class="n">Kki</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kki&quot;</span><span class="p">]</span>
        <span class="n">Kko</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kko&quot;</span><span class="p">]</span>
        <span class="n">Kmgatp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kmgatp&quot;</span><span class="p">]</span>
        <span class="n">Knai0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Knai0&quot;</span><span class="p">]</span>
        <span class="n">Knao0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Knao0&quot;</span><span class="p">]</span>
        <span class="n">Knap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Knap&quot;</span><span class="p">]</span>
        <span class="n">Kxkur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Kxkur&quot;</span><span class="p">]</span>
        <span class="n">MgADP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;MgADP&quot;</span><span class="p">]</span>
        <span class="n">MgATP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;MgATP&quot;</span><span class="p">]</span>
        <span class="n">Pnak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Pnak&quot;</span><span class="p">]</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span>
        <span class="n">eP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;eP&quot;</span><span class="p">]</span>
        <span class="n">k1m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k1m&quot;</span><span class="p">]</span>
        <span class="n">k1p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k1p&quot;</span><span class="p">]</span>
        <span class="n">k2m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k2m&quot;</span><span class="p">]</span>
        <span class="n">k2p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k2p&quot;</span><span class="p">]</span>
        <span class="n">k3m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k3m&quot;</span><span class="p">]</span>
        <span class="n">k3p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k3p&quot;</span><span class="p">]</span>
        <span class="n">k4m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k4m&quot;</span><span class="p">]</span>
        <span class="n">k4p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;k4p&quot;</span><span class="p">]</span>
        <span class="n">zk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;zk&quot;</span><span class="p">]</span>
        <span class="n">GKb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;GKb&quot;</span><span class="p">]</span>
        <span class="n">PNab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;PNab&quot;</span><span class="p">]</span>
        <span class="n">PCab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;PCab&quot;</span><span class="p">]</span>
        <span class="n">GpCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;GpCa&quot;</span><span class="p">]</span>
        <span class="n">bt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;bt&quot;</span><span class="p">]</span>
        <span class="n">BSLmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;BSLmax&quot;</span><span class="p">]</span>
        <span class="n">BSRmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;BSRmax&quot;</span><span class="p">]</span>
        <span class="n">KmBSL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;KmBSL&quot;</span><span class="p">]</span>
        <span class="n">KmBSR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;KmBSR&quot;</span><span class="p">]</span>
        <span class="n">cmdnmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;cmdnmax&quot;</span><span class="p">]</span>
        <span class="n">csqnmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;csqnmax&quot;</span><span class="p">]</span>
        <span class="n">kmcmdn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kmcmdn&quot;</span><span class="p">]</span>
        <span class="n">kmcsqn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kmcsqn&quot;</span><span class="p">]</span>
        <span class="n">trpnmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;trpnmax&quot;</span><span class="p">]</span>
        <span class="n">Beta1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Beta1&quot;</span><span class="p">]</span>

        <span class="n">Trpn50</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;Trpn50&quot;</span><span class="p">]</span>
        <span class="n">cat50_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;cat50_ref&quot;</span><span class="p">]</span>

        <span class="n">etal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;etal&quot;</span><span class="p">]</span>
        <span class="n">etas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;etas&quot;</span><span class="p">]</span>
        <span class="n">gammas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;gammas&quot;</span><span class="p">]</span>
        <span class="n">gammaw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;gammaw&quot;</span><span class="p">]</span>
        <span class="n">ktrpn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;ktrpn&quot;</span><span class="p">]</span>
        <span class="n">ku</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;ku&quot;</span><span class="p">]</span>
        <span class="n">kuw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kuw&quot;</span><span class="p">]</span>
        <span class="n">kws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;kws&quot;</span><span class="p">]</span>
        <span class="c1"># lmbda = self._parameters[&quot;lmbda&quot;]</span>
        <span class="n">ntm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;ntm&quot;</span><span class="p">]</span>
        <span class="n">ntrpn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;ntrpn&quot;</span><span class="p">]</span>
        <span class="n">p_k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;p_k&quot;</span><span class="p">]</span>

        <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;rs&quot;</span><span class="p">]</span>
        <span class="n">rw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;rw&quot;</span><span class="p">]</span>

        <span class="c1"># Zetas = self._parameters[&quot;Zetas&quot;]</span>
        <span class="c1"># Zetaw = self._parameters[&quot;Zetaw&quot;]</span>

        <span class="c1"># Drug factor</span>
        <span class="n">scale_drug_INa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_INa&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_INaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_INaL&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_Ito</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_Ito&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_ICaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_ICaL&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IKr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IKr&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IKs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IKs&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IK1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IK1&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IKb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IKb&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_INab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_INab&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_ICab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_ICab&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_IpCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_IpCa&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_Isacns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_Isacns&quot;</span><span class="p">]</span>
        <span class="n">scale_drug_Isack</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_drug_Isack&quot;</span><span class="p">]</span>

        <span class="c1"># Population factors</span>
        <span class="n">scale_popu_GNa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GNa&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GCaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GCaL&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_Gto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_Gto&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GNaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GNaL&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GKr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GKr&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GKs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GKs&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GK1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GK1&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GbK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GbK&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_KNCX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_KNCX&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_KNaK</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_KNaK&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GbNa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GbNa&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_GbCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_GbCa&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_KpCa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_KpCa&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_KRyR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_KRyR&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_KSERCA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_KSERCA&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_Kleak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_Kleak&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_nTm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_nTm&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_CaT50ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_CaT50ref&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_kuw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_kuw&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_kws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_kws&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_kTRPN</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_kTRPN&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_nTRPN</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_nTRPN&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_ku</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_ku&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_TRPN50</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_TRPN50&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_rw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_rw&quot;</span><span class="p">]</span>
        <span class="n">scale_popu_rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;scale_popu_rs&quot;</span><span class="p">]</span>

        <span class="c1"># Systolic Heart Failure (HF with preserved ejection fraction)</span>
        <span class="n">HF_scaling_CaMKa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_CaMKa&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Jrel_inf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Jrel_inf&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Jleak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Jleak&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Jup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Jup&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_GNaL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_GNaL&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_GK1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_GK1&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_thL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_thL&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Gto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Gto&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Gncx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Gncx&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_Pnak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_Pnak&quot;</span><span class="p">]</span>
        <span class="n">HF_scaling_cat50_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="s2">&quot;HF_scaling_cat50_ref&quot;</span><span class="p">]</span>

        <span class="c1"># Init return args</span>
        <span class="n">F_expressions</span> <span class="o">=</span> <span class="p">[</span><span class="n">dolfin</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">48</span>

        <span class="c1"># Expressions for the cell geometry component</span>
        <span class="n">vcell</span> <span class="o">=</span> <span class="mf">3140.0</span> <span class="o">*</span> <span class="n">L</span> <span class="o">*</span> <span class="p">(</span><span class="n">rad</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span>
        <span class="n">Ageo</span> <span class="o">=</span> <span class="mf">6.28</span> <span class="o">*</span> <span class="p">(</span><span class="n">rad</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span> <span class="o">+</span> <span class="mf">6.28</span> <span class="o">*</span> <span class="n">L</span> <span class="o">*</span> <span class="n">rad</span>
        <span class="n">Acap</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Ageo</span>
        <span class="n">vmyo</span> <span class="o">=</span> <span class="mf">0.68</span> <span class="o">*</span> <span class="n">vcell</span>
        <span class="n">vnsr</span> <span class="o">=</span> <span class="mf">0.0552</span> <span class="o">*</span> <span class="n">vcell</span>
        <span class="n">vjsr</span> <span class="o">=</span> <span class="mf">0.0048</span> <span class="o">*</span> <span class="n">vcell</span>
        <span class="n">vss</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">vcell</span>

        <span class="c1"># Expressions for the CaMKt component</span>
        <span class="n">CaMKb</span> <span class="o">=</span> <span class="n">CaMKo</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">CaMKt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaM</span> <span class="o">/</span> <span class="n">cass</span><span class="p">)</span>
        <span class="n">CaMKa</span> <span class="o">=</span> <span class="p">(</span><span class="n">CaMKb</span> <span class="o">+</span> <span class="n">CaMKt</span><span class="p">)</span> <span class="o">*</span> <span class="n">HF_scaling_CaMKa</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">bCaMK</span> <span class="o">*</span> <span class="n">CaMKt</span> <span class="o">+</span> <span class="n">aCaMK</span> <span class="o">*</span> <span class="p">(</span><span class="n">CaMKb</span> <span class="o">+</span> <span class="n">CaMKt</span><span class="p">)</span> <span class="o">*</span> <span class="n">CaMKb</span>

        <span class="c1"># Expressions for the reversal potentials component</span>
        <span class="n">ENa</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">nao</span> <span class="o">/</span> <span class="n">nai</span><span class="p">)</span> <span class="o">/</span> <span class="n">F</span>
        <span class="n">EK</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">ko</span> <span class="o">/</span> <span class="n">ki</span><span class="p">)</span> <span class="o">/</span> <span class="n">F</span>
        <span class="n">EKs</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">ln</span><span class="p">((</span><span class="n">ko</span> <span class="o">+</span> <span class="n">PKNa</span> <span class="o">*</span> <span class="n">nao</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">PKNa</span> <span class="o">*</span> <span class="n">nai</span> <span class="o">+</span> <span class="n">ki</span><span class="p">))</span> <span class="o">/</span> <span class="n">F</span>
        <span class="n">vffrt</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">F</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
        <span class="n">vfrt</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>

        <span class="c1"># Expressions for the I_Na component</span>
        <span class="n">mss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.0014599788446489682</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.13333333333333333</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">tm</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">9.454904638564724</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.02876042565429968</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">1.9314113558536928e-05</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.16792611251049538</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">m</span> <span class="o">+</span> <span class="n">mss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tm</span>
        <span class="n">hss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">302724.605401998</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.1607717041800643</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">thf</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">1.183856958289087e-05</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.15910898965791567</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">6.305549185817275</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.0493339911198816</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">ths</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.005164670235381792</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.035650623885918005</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.36987619372096325</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.017649135192375574</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">Ahs</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">Ahf</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">hf</span> <span class="o">+</span> <span class="n">hss</span><span class="p">)</span> <span class="o">/</span> <span class="n">thf</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">hs</span> <span class="o">+</span> <span class="n">hss</span><span class="p">)</span> <span class="o">/</span> <span class="n">ths</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">Ahf</span> <span class="o">*</span> <span class="n">hf</span> <span class="o">+</span> <span class="n">Ahs</span> <span class="o">*</span> <span class="n">hs</span>
        <span class="n">jss</span> <span class="o">=</span> <span class="n">hss</span>
        <span class="n">tj</span> <span class="o">=</span> <span class="mf">2.038</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.3131936394738773</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.02600780234070221</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">1.1315282095590072e-07</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.12075836251660427</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">j</span> <span class="o">+</span> <span class="n">jss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tj</span>
        <span class="n">hssp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">820249.0921708513</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.1607717041800643</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">thsp</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">ths</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">hsp</span> <span class="o">+</span> <span class="n">hssp</span><span class="p">)</span> <span class="o">/</span> <span class="n">thsp</span>
        <span class="n">hp</span> <span class="o">=</span> <span class="n">Ahf</span> <span class="o">*</span> <span class="n">hf</span> <span class="o">+</span> <span class="n">Ahs</span> <span class="o">*</span> <span class="n">hsp</span>
        <span class="n">tjp</span> <span class="o">=</span> <span class="mf">1.46</span> <span class="o">*</span> <span class="n">tj</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">jp</span> <span class="o">+</span> <span class="n">jss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tjp</span>
        <span class="n">fINap</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">INa</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">GNa</span>
            <span class="o">*</span> <span class="n">scale_drug_INa</span>
            <span class="o">*</span> <span class="n">scale_popu_GNa</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">ENa</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fINap</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="n">fINap</span> <span class="o">*</span> <span class="n">hp</span> <span class="o">*</span> <span class="n">jp</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the INaL component</span>
        <span class="n">mLss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.000291579585635531</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.18996960486322187</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">tmL</span> <span class="o">=</span> <span class="n">tm</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">mL</span> <span class="o">+</span> <span class="n">mLss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tmL</span>
        <span class="n">hLss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">120578.15595522427</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.13354700854700854</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">hL</span> <span class="o">+</span> <span class="n">hLss</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">thL</span> <span class="o">*</span> <span class="n">HF_scaling_thL</span><span class="p">)</span>
        <span class="n">hLssp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">275969.2903869871</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.13354700854700854</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">thLp</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">thL</span> <span class="o">*</span> <span class="n">HF_scaling_thL</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">hLp</span> <span class="o">+</span> <span class="n">hLssp</span><span class="p">)</span> <span class="o">/</span> <span class="n">thLp</span>
        <span class="n">GNaL</span> <span class="o">=</span> <span class="mf">0.0075</span> <span class="o">*</span> <span class="n">scale_INaL</span> <span class="o">*</span> <span class="n">scale_drug_INaL</span> <span class="o">*</span> <span class="n">scale_popu_GNaL</span> <span class="o">*</span> <span class="n">HF_scaling_GNaL</span>
        <span class="n">fINaLp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">INaL</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ENa</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fINaLp</span><span class="p">)</span> <span class="o">*</span> <span class="n">hL</span> <span class="o">+</span> <span class="n">fINaLp</span> <span class="o">*</span> <span class="n">hLp</span><span class="p">)</span> <span class="o">*</span> <span class="n">GNaL</span> <span class="o">*</span> <span class="n">mL</span>

        <span class="c1"># Expressions for the Ito component</span>
        <span class="n">ass</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.6316508161673635</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.06747638326585695</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">ta</span> <span class="o">=</span> <span class="mf">1.0515</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.2089</span> <span class="o">+</span> <span class="mf">2.2621017070578837</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03403513787634354</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
            <span class="o">+</span> <span class="mf">3.5</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">30.069572727397507</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.03403513787634354</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="n">ass</span><span class="p">)</span> <span class="o">/</span> <span class="n">ta</span>
        <span class="n">iss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2194.970764538301</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.17510068289266328</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">tiF</span> <span class="o">=</span> <span class="mf">4.562</span> <span class="o">+</span> <span class="n">delta_epi</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.14468698421272827</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">1.6300896349780942</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.06027727546714889</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">tiS</span> <span class="o">=</span> <span class="mf">23.62</span> <span class="o">+</span> <span class="n">delta_epi</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.00027617763953377436</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01693480101608806</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.024208962804604526</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.12377769525931426</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">AiF</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.24348537187522867</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.006613756613756614</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">AiS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">AiF</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">iF</span> <span class="o">+</span> <span class="n">iss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tiF</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">iS</span> <span class="o">+</span> <span class="n">iss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tiS</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">AiF</span> <span class="o">*</span> <span class="n">iF</span> <span class="o">+</span> <span class="n">AiS</span> <span class="o">*</span> <span class="n">iS</span>
        <span class="n">assp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">5.167428462230666</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.06747638326585695</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ap</span> <span class="o">+</span> <span class="n">assp</span><span class="p">)</span> <span class="o">/</span> <span class="n">ta</span>
        <span class="n">dti_develop</span> <span class="o">=</span> <span class="mf">1.354</span> <span class="o">+</span> <span class="mf">0.0001</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">2.6591269045230603e-05</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.06293266205160478</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">4.5541779737128264e24</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">4.642525533890436</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">dti_recover</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">33.11545195869231</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">tiFp</span> <span class="o">=</span> <span class="n">dti_develop</span> <span class="o">*</span> <span class="n">dti_recover</span> <span class="o">*</span> <span class="n">tiF</span>
        <span class="n">tiSp</span> <span class="o">=</span> <span class="n">dti_develop</span> <span class="o">*</span> <span class="n">dti_recover</span> <span class="o">*</span> <span class="n">tiS</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">iFp</span> <span class="o">+</span> <span class="n">iss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tiFp</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">iSp</span> <span class="o">+</span> <span class="n">iss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tiSp</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">AiF</span> <span class="o">*</span> <span class="n">iFp</span> <span class="o">+</span> <span class="n">AiS</span> <span class="o">*</span> <span class="n">iSp</span>
        <span class="n">fItop</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">Ito</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Gto</span>
            <span class="o">*</span> <span class="n">scale_drug_Ito</span>
            <span class="o">*</span> <span class="n">scale_popu_Gto</span>
            <span class="o">*</span> <span class="n">HF_scaling_Gto</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EK</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fItop</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">ap</span> <span class="o">*</span> <span class="n">fItop</span> <span class="o">*</span> <span class="n">ip</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the ICaL ICaNa ICaK component</span>
        <span class="n">dss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.39398514226669484</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.23640661938534277</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">td</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">3.5254214873653824</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.09</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.7408182206817179</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span> <span class="o">+</span> <span class="n">dss</span><span class="p">)</span> <span class="o">/</span> <span class="n">td</span>
        <span class="n">fss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">199.86038496778565</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.27056277056277056</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">tff</span> <span class="o">=</span> <span class="mf">7.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.03325075244518792</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.0006090087745647571</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">tfs</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">1.0027667890106652e-05</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">8.053415618124885e-05</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.16666666666666666</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">Afs</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">Aff</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ff</span> <span class="o">+</span> <span class="n">fss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tff</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">fs</span> <span class="o">+</span> <span class="n">fss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tfs</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">Aff</span> <span class="o">*</span> <span class="n">ff</span> <span class="o">+</span> <span class="n">Afs</span> <span class="o">*</span> <span class="n">fs</span>
        <span class="n">fcass</span> <span class="o">=</span> <span class="n">fss</span>
        <span class="n">tfcaf</span> <span class="o">=</span> <span class="mf">7.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.0708317980974062</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.14285714285714285</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.02258872488031037</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.14285714285714285</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">tfcas</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.00012</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.14285714285714285</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.00012</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3333333333333333</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">Afcaf</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.36787944117144233</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">Afcas</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">Afcaf</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">fcaf</span> <span class="o">+</span> <span class="n">fcass</span><span class="p">)</span> <span class="o">/</span> <span class="n">tfcaf</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">fcas</span> <span class="o">+</span> <span class="n">fcass</span><span class="p">)</span> <span class="o">/</span> <span class="n">tfcas</span>
        <span class="n">fca</span> <span class="o">=</span> <span class="n">Afcaf</span> <span class="o">*</span> <span class="n">fcaf</span> <span class="o">+</span> <span class="n">Afcas</span> <span class="o">*</span> <span class="n">fcas</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">jca</span> <span class="o">+</span> <span class="n">fcass</span><span class="p">)</span> <span class="o">/</span> <span class="n">tjca</span>
        <span class="n">tffp</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">tff</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ffp</span> <span class="o">+</span> <span class="n">fss</span><span class="p">)</span> <span class="o">/</span> <span class="n">tffp</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">Aff</span> <span class="o">*</span> <span class="n">ffp</span> <span class="o">+</span> <span class="n">Afs</span> <span class="o">*</span> <span class="n">fs</span>
        <span class="n">tfcafp</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">tfcaf</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">fcafp</span> <span class="o">+</span> <span class="n">fcass</span><span class="p">)</span> <span class="o">/</span> <span class="n">tfcafp</span>
        <span class="n">fcap</span> <span class="o">=</span> <span class="n">Afcaf</span> <span class="o">*</span> <span class="n">fcafp</span> <span class="o">+</span> <span class="n">Afcas</span> <span class="o">*</span> <span class="n">fcas</span>
        <span class="n">km2n</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">jca</span>
        <span class="n">anca</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">Kmn</span> <span class="o">/</span> <span class="n">cass</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">k2n</span> <span class="o">/</span> <span class="n">km2n</span><span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">k2n</span> <span class="o">*</span> <span class="n">anca</span> <span class="o">-</span> <span class="n">km2n</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="n">PhiCaL</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">4.0</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.341</span> <span class="o">*</span> <span class="n">cao</span> <span class="o">+</span> <span class="n">cass</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">PhiCaNa</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">1.0</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">nao</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">)</span> <span class="o">*</span> <span class="n">nass</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">PhiCaK</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">1.0</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.75</span> <span class="o">*</span> <span class="n">ko</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">)</span> <span class="o">*</span> <span class="n">kss</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">PCa</span> <span class="o">=</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">scale_ICaL</span> <span class="o">*</span> <span class="n">scale_drug_ICaL</span> <span class="o">*</span> <span class="n">scale_popu_GCaL</span>
        <span class="n">PCap</span> <span class="o">=</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">PCa</span>
        <span class="n">PCaNa</span> <span class="o">=</span> <span class="mf">0.00125</span> <span class="o">*</span> <span class="n">PCa</span>
        <span class="n">PCaK</span> <span class="o">=</span> <span class="mf">0.0003574</span> <span class="o">*</span> <span class="n">PCa</span>
        <span class="n">PCaNap</span> <span class="o">=</span> <span class="mf">0.00125</span> <span class="o">*</span> <span class="n">PCap</span>
        <span class="n">PCaKp</span> <span class="o">=</span> <span class="mf">0.0003574</span> <span class="o">*</span> <span class="n">PCap</span>
        <span class="n">fICaLp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">ICaL</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fICaLp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span> <span class="o">+</span> <span class="n">fca</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCa</span> <span class="o">*</span> <span class="n">PhiCaL</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">fp</span> <span class="o">+</span> <span class="n">fcap</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCap</span> <span class="o">*</span> <span class="n">PhiCaL</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">fICaLp</span>
        <span class="n">ICaNa</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fICaLp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span> <span class="o">+</span> <span class="n">fca</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCaNa</span> <span class="o">*</span> <span class="n">PhiCaNa</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">fp</span> <span class="o">+</span> <span class="n">fcap</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCaNap</span> <span class="o">*</span> <span class="n">PhiCaNa</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">fICaLp</span>
        <span class="n">ICaK</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fICaLp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span> <span class="o">+</span> <span class="n">fca</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCaK</span> <span class="o">*</span> <span class="n">PhiCaK</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">nca</span><span class="p">)</span> <span class="o">*</span> <span class="n">fp</span> <span class="o">+</span> <span class="n">fcap</span> <span class="o">*</span> <span class="n">jca</span> <span class="o">*</span> <span class="n">nca</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">PCaKp</span> <span class="o">*</span> <span class="n">PhiCaK</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">fICaLp</span>

        <span class="c1"># Expressions for the IKr component</span>
        <span class="n">xrss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.29287308872377504</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.14729709824716453</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">txrf</span> <span class="o">=</span> <span class="mf">12.98</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.0001020239312894894</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.25846471956577927</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.00042992960891929087</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.04906771344455348</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">txrs</span> <span class="o">=</span> <span class="mf">1.865</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.0005922420036809394</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.13596193065941536</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">3.549966111802463e-05</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03855050115651503</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">Axrf</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">4.197299094734718</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.02617115938236064</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">Axrs</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">Axrf</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">xrf</span> <span class="o">+</span> <span class="n">xrss</span><span class="p">)</span> <span class="o">/</span> <span class="n">txrf</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">xrs</span> <span class="o">+</span> <span class="n">xrss</span><span class="p">)</span> <span class="o">/</span> <span class="n">txrs</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">Axrf</span> <span class="o">*</span> <span class="n">xrf</span> <span class="o">+</span> <span class="n">Axrs</span> <span class="o">*</span> <span class="n">xrs</span>
        <span class="n">rkr</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.0820090840784555</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.013333333333333334</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.7165313105737893</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.03333333333333333</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">GKr</span> <span class="o">=</span> <span class="mf">0.046</span> <span class="o">*</span> <span class="n">scale_IKr</span> <span class="o">*</span> <span class="n">scale_drug_IKr</span> <span class="o">*</span> <span class="n">scale_popu_GKr</span>
        <span class="n">IKr</span> <span class="o">=</span> <span class="mf">0.4303314829119352</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ko</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EK</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">GKr</span> <span class="o">*</span> <span class="n">rkr</span> <span class="o">*</span> <span class="n">xr</span>

        <span class="c1"># Expressions for the IKs component</span>
        <span class="n">xs1ss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.27288596035656526</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.11195700850873264</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">txs1</span> <span class="o">=</span> <span class="mf">817.3</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.003504067763074858</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.056179775280898875</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.0005184809083581659</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.004347826086956522</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">xs1</span> <span class="o">+</span> <span class="n">xs1ss</span><span class="p">)</span> <span class="o">/</span> <span class="n">txs1</span>
        <span class="n">xs2ss</span> <span class="o">=</span> <span class="n">xs1ss</span>
        <span class="n">txs2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.0022561357010639103</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03225806451612903</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.0008208499862389881</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">xs2</span> <span class="o">+</span> <span class="n">xs2ss</span><span class="p">)</span> <span class="o">/</span> <span class="n">txs2</span>
        <span class="n">KsCa</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">6.481821026062645e-07</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">cai</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">))</span>
        <span class="n">GKs</span> <span class="o">=</span> <span class="mf">0.0034</span> <span class="o">*</span> <span class="n">scale_IKs</span> <span class="o">*</span> <span class="n">scale_drug_IKs</span> <span class="o">*</span> <span class="n">scale_popu_GKs</span>
        <span class="n">IKs</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">EKs</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">GKs</span> <span class="o">*</span> <span class="n">KsCa</span> <span class="o">*</span> <span class="n">xs1</span> <span class="o">*</span> <span class="n">xs2</span>
        <span class="n">xk1ss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="mf">144.59</span> <span class="o">-</span> <span class="n">v</span> <span class="o">-</span> <span class="mf">2.5538</span> <span class="o">*</span> <span class="n">ko</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.8115</span> <span class="o">+</span> <span class="mf">1.5692</span> <span class="o">*</span> <span class="n">ko</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">txk1</span> <span class="o">=</span> <span class="mf">122.2</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">0.0019352007631390235</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.049115913555992145</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">30.43364757524903</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.014423770373575654</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">xk1</span> <span class="o">+</span> <span class="n">xk1ss</span><span class="p">)</span> <span class="o">/</span> <span class="n">txk1</span>
        <span class="n">rk1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">1.0</span>
            <span class="o">+</span> <span class="mf">69220.6322106767</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.10534077741493732</span> <span class="o">*</span> <span class="n">v</span> <span class="o">-</span> <span class="mf">0.27388602127883704</span> <span class="o">*</span> <span class="n">ko</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">GK1</span> <span class="o">=</span> <span class="mf">0.1908</span> <span class="o">*</span> <span class="n">scale_IK1</span> <span class="o">*</span> <span class="n">scale_drug_IK1</span> <span class="o">*</span> <span class="n">scale_popu_GK1</span> <span class="o">*</span> <span class="n">HF_scaling_GK1</span>
        <span class="n">IK1</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ko</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EK</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">GK1</span> <span class="o">*</span> <span class="n">rk1</span> <span class="o">*</span> <span class="n">xk1</span>

        <span class="c1"># Expressions for the INaCa_i component</span>
        <span class="n">hca</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">qca</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">hna</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">qna</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">h1_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">hna</span><span class="p">)</span> <span class="o">*</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">kna3</span>
        <span class="n">h2_i</span> <span class="o">=</span> <span class="n">hna</span> <span class="o">*</span> <span class="n">nai</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna3</span> <span class="o">*</span> <span class="n">h1_i</span><span class="p">)</span>
        <span class="n">h3_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h1_i</span>
        <span class="n">h4_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">kna2</span><span class="p">)</span> <span class="o">*</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">kna1</span>
        <span class="n">h5_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">nai</span> <span class="o">*</span> <span class="n">nai</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna1</span> <span class="o">*</span> <span class="n">kna2</span> <span class="o">*</span> <span class="n">h4_i</span><span class="p">)</span>
        <span class="n">h6_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h4_i</span>
        <span class="n">h7_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">hna</span><span class="p">)</span> <span class="o">/</span> <span class="n">kna3</span>
        <span class="n">h8_i</span> <span class="o">=</span> <span class="n">nao</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna3</span> <span class="o">*</span> <span class="n">h7_i</span> <span class="o">*</span> <span class="n">hna</span><span class="p">)</span>
        <span class="n">h9_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h7_i</span>
        <span class="n">h10_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">kasymm</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">/</span> <span class="n">kna2</span><span class="p">)</span> <span class="o">/</span> <span class="n">kna1</span>
        <span class="n">h11_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">nao</span> <span class="o">*</span> <span class="n">nao</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna1</span> <span class="o">*</span> <span class="n">kna2</span> <span class="o">*</span> <span class="n">h10_i</span><span class="p">)</span>
        <span class="n">h12_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h10_i</span>
        <span class="n">k1_i</span> <span class="o">=</span> <span class="n">cao</span> <span class="o">*</span> <span class="n">kcaon</span> <span class="o">*</span> <span class="n">h12_i</span>
        <span class="n">k2_i</span> <span class="o">=</span> <span class="n">kcaoff</span>
        <span class="n">k3p_i</span> <span class="o">=</span> <span class="n">wca</span> <span class="o">*</span> <span class="n">h9_i</span>
        <span class="n">k3pp_i</span> <span class="o">=</span> <span class="n">wnaca</span> <span class="o">*</span> <span class="n">h8_i</span>
        <span class="n">k3_i</span> <span class="o">=</span> <span class="n">k3p_i</span> <span class="o">+</span> <span class="n">k3pp_i</span>
        <span class="n">k4p_i</span> <span class="o">=</span> <span class="n">wca</span> <span class="o">*</span> <span class="n">h3_i</span> <span class="o">/</span> <span class="n">hca</span>
        <span class="n">k4pp_i</span> <span class="o">=</span> <span class="n">wnaca</span> <span class="o">*</span> <span class="n">h2_i</span>
        <span class="n">k4_i</span> <span class="o">=</span> <span class="n">k4p_i</span> <span class="o">+</span> <span class="n">k4pp_i</span>
        <span class="n">k5_i</span> <span class="o">=</span> <span class="n">kcaoff</span>
        <span class="n">k6_i</span> <span class="o">=</span> <span class="n">kcaon</span> <span class="o">*</span> <span class="n">cai</span> <span class="o">*</span> <span class="n">h6_i</span>
        <span class="n">k7_i</span> <span class="o">=</span> <span class="n">wna</span> <span class="o">*</span> <span class="n">h2_i</span> <span class="o">*</span> <span class="n">h5_i</span>
        <span class="n">k8_i</span> <span class="o">=</span> <span class="n">wna</span> <span class="o">*</span> <span class="n">h11_i</span> <span class="o">*</span> <span class="n">h8_i</span>
        <span class="n">x1_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2_i</span> <span class="o">+</span> <span class="n">k3_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k5_i</span> <span class="o">*</span> <span class="n">k7_i</span> <span class="o">+</span> <span class="p">(</span><span class="n">k6_i</span> <span class="o">+</span> <span class="n">k7_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2_i</span> <span class="o">*</span> <span class="n">k4_i</span>
        <span class="n">x2_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1_i</span> <span class="o">+</span> <span class="n">k8_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k4_i</span> <span class="o">*</span> <span class="n">k6_i</span> <span class="o">+</span> <span class="p">(</span><span class="n">k4_i</span> <span class="o">+</span> <span class="n">k5_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k1_i</span> <span class="o">*</span> <span class="n">k7_i</span>
        <span class="n">x3_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2_i</span> <span class="o">+</span> <span class="n">k3_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k6_i</span> <span class="o">*</span> <span class="n">k8_i</span> <span class="o">+</span> <span class="p">(</span><span class="n">k6_i</span> <span class="o">+</span> <span class="n">k7_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k1_i</span> <span class="o">*</span> <span class="n">k3_i</span>
        <span class="n">x4_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1_i</span> <span class="o">+</span> <span class="n">k8_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k3_i</span> <span class="o">*</span> <span class="n">k5_i</span> <span class="o">+</span> <span class="p">(</span><span class="n">k4_i</span> <span class="o">+</span> <span class="n">k5_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2_i</span> <span class="o">*</span> <span class="n">k8_i</span>
        <span class="n">E1_i</span> <span class="o">=</span> <span class="n">x1_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_i</span> <span class="o">+</span> <span class="n">x2_i</span> <span class="o">+</span> <span class="n">x3_i</span> <span class="o">+</span> <span class="n">x4_i</span><span class="p">)</span>
        <span class="n">E2_i</span> <span class="o">=</span> <span class="n">x2_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_i</span> <span class="o">+</span> <span class="n">x2_i</span> <span class="o">+</span> <span class="n">x3_i</span> <span class="o">+</span> <span class="n">x4_i</span><span class="p">)</span>
        <span class="n">E3_i</span> <span class="o">=</span> <span class="n">x3_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_i</span> <span class="o">+</span> <span class="n">x2_i</span> <span class="o">+</span> <span class="n">x3_i</span> <span class="o">+</span> <span class="n">x4_i</span><span class="p">)</span>
        <span class="n">E4_i</span> <span class="o">=</span> <span class="n">x4_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_i</span> <span class="o">+</span> <span class="n">x2_i</span> <span class="o">+</span> <span class="n">x3_i</span> <span class="o">+</span> <span class="n">x4_i</span><span class="p">)</span>
        <span class="n">allo_i</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">KmCaAct</span> <span class="o">/</span> <span class="n">cai</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
        <span class="n">zna</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">JncxNa_i</span> <span class="o">=</span> <span class="n">E3_i</span> <span class="o">*</span> <span class="n">k4pp_i</span> <span class="o">-</span> <span class="n">E2_i</span> <span class="o">*</span> <span class="n">k3pp_i</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E4_i</span> <span class="o">*</span> <span class="n">k7_i</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E1_i</span> <span class="o">*</span> <span class="n">k8_i</span>
        <span class="n">JncxCa_i</span> <span class="o">=</span> <span class="n">E2_i</span> <span class="o">*</span> <span class="n">k2_i</span> <span class="o">-</span> <span class="n">E1_i</span> <span class="o">*</span> <span class="n">k1_i</span>
        <span class="n">INaCa_i</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">0.8</span>
            <span class="o">*</span> <span class="n">Gncx</span>
            <span class="o">*</span> <span class="n">scale_popu_KNCX</span>
            <span class="o">*</span> <span class="n">HF_scaling_Gncx</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">zca</span> <span class="o">*</span> <span class="n">JncxCa_i</span> <span class="o">+</span> <span class="n">zna</span> <span class="o">*</span> <span class="n">JncxNa_i</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">allo_i</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the INaCa_ss component</span>
        <span class="n">h1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">hna</span><span class="p">)</span> <span class="o">*</span> <span class="n">nass</span> <span class="o">/</span> <span class="n">kna3</span>
        <span class="n">h2</span> <span class="o">=</span> <span class="n">hna</span> <span class="o">*</span> <span class="n">nass</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna3</span> <span class="o">*</span> <span class="n">h1</span><span class="p">)</span>
        <span class="n">h3</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h1</span>
        <span class="n">h4</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nass</span> <span class="o">/</span> <span class="n">kna2</span><span class="p">)</span> <span class="o">*</span> <span class="n">nass</span> <span class="o">/</span> <span class="n">kna1</span>
        <span class="n">h5</span> <span class="o">=</span> <span class="p">(</span><span class="n">nass</span> <span class="o">*</span> <span class="n">nass</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna1</span> <span class="o">*</span> <span class="n">kna2</span> <span class="o">*</span> <span class="n">h4</span><span class="p">)</span>
        <span class="n">h6</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h4</span>
        <span class="n">h7</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">hna</span><span class="p">)</span> <span class="o">/</span> <span class="n">kna3</span>
        <span class="n">h8</span> <span class="o">=</span> <span class="n">nao</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna3</span> <span class="o">*</span> <span class="n">h7</span> <span class="o">*</span> <span class="n">hna</span><span class="p">)</span>
        <span class="n">h9</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h7</span>
        <span class="n">h10</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">kasymm</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">/</span> <span class="n">kna2</span><span class="p">)</span> <span class="o">/</span> <span class="n">kna1</span>
        <span class="n">h11</span> <span class="o">=</span> <span class="p">(</span><span class="n">nao</span> <span class="o">*</span> <span class="n">nao</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kna1</span> <span class="o">*</span> <span class="n">kna2</span> <span class="o">*</span> <span class="n">h10</span><span class="p">)</span>
        <span class="n">h12</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">h10</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">cao</span> <span class="o">*</span> <span class="n">kcaon</span> <span class="o">*</span> <span class="n">h12</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="n">kcaoff</span>
        <span class="n">k3p_ss</span> <span class="o">=</span> <span class="n">wca</span> <span class="o">*</span> <span class="n">h9</span>
        <span class="n">k3pp</span> <span class="o">=</span> <span class="n">wnaca</span> <span class="o">*</span> <span class="n">h8</span>
        <span class="n">k3</span> <span class="o">=</span> <span class="n">k3p_ss</span> <span class="o">+</span> <span class="n">k3pp</span>
        <span class="n">k4p_ss</span> <span class="o">=</span> <span class="n">wca</span> <span class="o">*</span> <span class="n">h3</span> <span class="o">/</span> <span class="n">hca</span>
        <span class="n">k4pp</span> <span class="o">=</span> <span class="n">wnaca</span> <span class="o">*</span> <span class="n">h2</span>
        <span class="n">k4</span> <span class="o">=</span> <span class="n">k4p_ss</span> <span class="o">+</span> <span class="n">k4pp</span>
        <span class="n">k5</span> <span class="o">=</span> <span class="n">kcaoff</span>
        <span class="n">k6</span> <span class="o">=</span> <span class="n">kcaon</span> <span class="o">*</span> <span class="n">cass</span> <span class="o">*</span> <span class="n">h6</span>
        <span class="n">k7</span> <span class="o">=</span> <span class="n">wna</span> <span class="o">*</span> <span class="n">h2</span> <span class="o">*</span> <span class="n">h5</span>
        <span class="n">k8</span> <span class="o">=</span> <span class="n">wna</span> <span class="o">*</span> <span class="n">h11</span> <span class="o">*</span> <span class="n">h8</span>
        <span class="n">x1_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">*</span> <span class="n">k5</span> <span class="o">*</span> <span class="n">k7</span> <span class="o">+</span> <span class="p">(</span><span class="n">k6</span> <span class="o">+</span> <span class="n">k7</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">*</span> <span class="n">k4</span>
        <span class="n">x2_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="n">k8</span><span class="p">)</span> <span class="o">*</span> <span class="n">k4</span> <span class="o">*</span> <span class="n">k6</span> <span class="o">+</span> <span class="p">(</span><span class="n">k4</span> <span class="o">+</span> <span class="n">k5</span><span class="p">)</span> <span class="o">*</span> <span class="n">k1</span> <span class="o">*</span> <span class="n">k7</span>
        <span class="n">x3_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">*</span> <span class="n">k6</span> <span class="o">*</span> <span class="n">k8</span> <span class="o">+</span> <span class="p">(</span><span class="n">k6</span> <span class="o">+</span> <span class="n">k7</span><span class="p">)</span> <span class="o">*</span> <span class="n">k1</span> <span class="o">*</span> <span class="n">k3</span>
        <span class="n">x4_ss</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="n">k8</span><span class="p">)</span> <span class="o">*</span> <span class="n">k3</span> <span class="o">*</span> <span class="n">k5</span> <span class="o">+</span> <span class="p">(</span><span class="n">k4</span> <span class="o">+</span> <span class="n">k5</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">*</span> <span class="n">k8</span>
        <span class="n">E1_ss</span> <span class="o">=</span> <span class="n">x1_ss</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_ss</span> <span class="o">+</span> <span class="n">x2_ss</span> <span class="o">+</span> <span class="n">x3_ss</span> <span class="o">+</span> <span class="n">x4_ss</span><span class="p">)</span>
        <span class="n">E2_ss</span> <span class="o">=</span> <span class="n">x2_ss</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_ss</span> <span class="o">+</span> <span class="n">x2_ss</span> <span class="o">+</span> <span class="n">x3_ss</span> <span class="o">+</span> <span class="n">x4_ss</span><span class="p">)</span>
        <span class="n">E3_ss</span> <span class="o">=</span> <span class="n">x3_ss</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_ss</span> <span class="o">+</span> <span class="n">x2_ss</span> <span class="o">+</span> <span class="n">x3_ss</span> <span class="o">+</span> <span class="n">x4_ss</span><span class="p">)</span>
        <span class="n">E4_ss</span> <span class="o">=</span> <span class="n">x4_ss</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1_ss</span> <span class="o">+</span> <span class="n">x2_ss</span> <span class="o">+</span> <span class="n">x3_ss</span> <span class="o">+</span> <span class="n">x4_ss</span><span class="p">)</span>
        <span class="n">allo_ss</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">KmCaAct</span> <span class="o">/</span> <span class="n">cass</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
        <span class="n">JncxNa_ss</span> <span class="o">=</span> <span class="n">E3_ss</span> <span class="o">*</span> <span class="n">k4pp</span> <span class="o">-</span> <span class="n">E2_ss</span> <span class="o">*</span> <span class="n">k3pp</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E4_ss</span> <span class="o">*</span> <span class="n">k7</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E1_ss</span> <span class="o">*</span> <span class="n">k8</span>
        <span class="n">JncxCa_ss</span> <span class="o">=</span> <span class="n">E2_ss</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">-</span> <span class="n">E1_ss</span> <span class="o">*</span> <span class="n">k1</span>
        <span class="n">INaCa_ss</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">0.2</span>
            <span class="o">*</span> <span class="n">Gncx</span>
            <span class="o">*</span> <span class="n">scale_popu_KNCX</span>
            <span class="o">*</span> <span class="n">HF_scaling_Gncx</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">zca</span> <span class="o">*</span> <span class="n">JncxCa_ss</span> <span class="o">+</span> <span class="n">zna</span> <span class="o">*</span> <span class="n">JncxNa_ss</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">allo_ss</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the INaK component</span>
        <span class="n">Knai</span> <span class="o">=</span> <span class="n">Knai0</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3333333333333333</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">Knao</span> <span class="o">=</span> <span class="n">Knao0</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.3333333333333333</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">eP</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">H</span> <span class="o">/</span> <span class="n">Khp</span> <span class="o">+</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">Knap</span> <span class="o">+</span> <span class="n">ki</span> <span class="o">/</span> <span class="n">Kxkur</span><span class="p">)</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">k1p</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">nai</span> <span class="o">/</span> <span class="n">Knai</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="o">-</span><span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ki</span> <span class="o">/</span> <span class="n">Kki</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">Knai</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">MgADP</span> <span class="o">*</span> <span class="n">k1m</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">k2p</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">k2m</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">nao</span> <span class="o">/</span> <span class="n">Knao</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="o">-</span><span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ko</span> <span class="o">/</span> <span class="n">Kko</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">/</span> <span class="n">Knao</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">a3</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">k3p</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">ko</span> <span class="o">/</span> <span class="n">Kko</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="o">-</span><span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ko</span> <span class="o">/</span> <span class="n">Kko</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nao</span> <span class="o">/</span> <span class="n">Knao</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">b3</span> <span class="o">=</span> <span class="n">H</span> <span class="o">*</span> <span class="n">k3m</span> <span class="o">*</span> <span class="n">P</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">MgATP</span> <span class="o">/</span> <span class="n">Kmgatp</span><span class="p">)</span>
        <span class="n">a4</span> <span class="o">=</span> <span class="n">MgATP</span> <span class="o">*</span> <span class="n">k4p</span> <span class="o">/</span> <span class="p">(</span><span class="n">Kmgatp</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">MgATP</span> <span class="o">/</span> <span class="n">Kmgatp</span><span class="p">))</span>
        <span class="n">b4</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">k4m</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">ki</span> <span class="o">/</span> <span class="n">Kki</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="o">-</span><span class="mf">1.0</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ki</span> <span class="o">/</span> <span class="n">Kki</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">nai</span> <span class="o">/</span> <span class="n">Knai</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">+</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">b4</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">b4</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b4</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b4</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b4</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">a4</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b3</span>
        <span class="n">x4</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">+</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">a4</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">+</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">b3</span> <span class="o">*</span> <span class="n">b4</span>
        <span class="n">E1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">E2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">E3</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">E4</span> <span class="o">=</span> <span class="n">x4</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">JnakNa</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E1</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">E2</span> <span class="o">*</span> <span class="n">b3</span>
        <span class="n">JnakK</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">E4</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">E3</span> <span class="o">*</span> <span class="n">a1</span>
        <span class="n">INaK</span> <span class="o">=</span> <span class="n">Pnak</span> <span class="o">*</span> <span class="n">scale_popu_KNaK</span> <span class="o">*</span> <span class="n">HF_scaling_Pnak</span> <span class="o">*</span> <span class="p">(</span><span class="n">zk</span> <span class="o">*</span> <span class="n">JnakK</span> <span class="o">+</span> <span class="n">zna</span> <span class="o">*</span> <span class="n">JnakNa</span><span class="p">)</span>

        <span class="c1"># Expressions for the IKb component</span>
        <span class="n">xkb</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.202363450949239</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05452562704471101</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">IKb</span> <span class="o">=</span> <span class="n">GKb</span> <span class="o">*</span> <span class="n">scale_popu_GbK</span> <span class="o">*</span> <span class="n">scale_drug_IKb</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">EK</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">xkb</span>

        <span class="c1"># Expressions for the INab component</span>
        <span class="n">INab</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">PNab</span>
            <span class="o">*</span> <span class="n">scale_drug_INab</span>
            <span class="o">*</span> <span class="n">scale_popu_GbNa</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">nao</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">vfrt</span><span class="p">)</span> <span class="o">*</span> <span class="n">nai</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the ICab component</span>
        <span class="n">ICab</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">4.0</span>
            <span class="o">*</span> <span class="n">PCab</span>
            <span class="o">*</span> <span class="n">scale_drug_ICab</span>
            <span class="o">*</span> <span class="n">scale_popu_GbCa</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.341</span> <span class="o">*</span> <span class="n">cao</span> <span class="o">+</span> <span class="n">cai</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
            <span class="o">*</span> <span class="n">vffrt</span>
            <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">vfrt</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the IpCa component</span>
        <span class="n">IpCa</span> <span class="o">=</span> <span class="n">GpCa</span> <span class="o">*</span> <span class="n">scale_drug_IpCa</span> <span class="o">*</span> <span class="n">scale_popu_KpCa</span> <span class="o">*</span> <span class="n">cai</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.0005</span> <span class="o">+</span> <span class="n">cai</span><span class="p">)</span>

        <span class="c1"># Expressions for the Isac (Pueyo)--&gt; ns + k component</span>
        <span class="n">Gsac_ns</span> <span class="o">=</span> <span class="mf">0.006</span> <span class="o">*</span> <span class="n">scale_drug_Isacns</span>
        <span class="n">Esac_ns</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span>
        <span class="n">lambda_max</span> <span class="o">=</span> <span class="mf">1.1</span>
        <span class="n">Gsac_k</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.2882</span> <span class="o">*</span> <span class="mf">800.0</span> <span class="o">/</span> <span class="mf">210.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale_drug_Isack</span>  <span class="c1"># Pueyo endo</span>
        <span class="n">Isac_P_ns</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span>
            <span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">lmbda</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="mf">0.0</span><span class="p">,</span>
            <span class="n">Gsac_ns</span> <span class="o">*</span> <span class="p">((</span><span class="n">lmbda</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">lambda_max</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">Esac_ns</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">Isac_P_k</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span>
            <span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">lmbda</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="mf">0.0</span><span class="p">,</span>
            <span class="n">Gsac_k</span>
            <span class="o">*</span> <span class="p">((</span><span class="n">lmbda</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">lambda_max</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="mf">19.05</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">29.98</span><span class="p">)))),</span>
        <span class="p">)</span>

        <span class="c1"># Expressions for the Istim component</span>
        <span class="n">Istim</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># amp*(ufl.le(time, duration))</span>

        <span class="c1"># Expressions for the diffusion fluxes component</span>
        <span class="n">JdiffNa</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">nass</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">nai</span>
        <span class="n">JdiffK</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">kss</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">ki</span>
        <span class="n">Jdiff</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">cass</span> <span class="o">-</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">cai</span>

        <span class="c1"># Expressions for the ryanodine receptor component</span>
        <span class="n">a_rel</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bt</span>
        <span class="n">Jrel_inf</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">ICaL</span>
            <span class="o">*</span> <span class="n">a_rel</span>
            <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">25.62890625</span> <span class="o">*</span> <span class="n">HF_scaling_Jrel_inf</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">cajsr</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">tau_rel_tmp</span> <span class="o">=</span> <span class="n">bt</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.0123</span> <span class="o">/</span> <span class="n">cajsr</span><span class="p">)</span>
        <span class="n">tau_rel</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">tau_rel_tmp</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">tau_rel_tmp</span><span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">Jrelnp</span> <span class="o">+</span> <span class="n">Jrel_inf</span><span class="p">)</span> <span class="o">/</span> <span class="n">tau_rel</span>
        <span class="n">btp</span> <span class="o">=</span> <span class="mf">1.25</span> <span class="o">*</span> <span class="n">bt</span>
        <span class="n">a_relp</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">btp</span>
        <span class="n">Jrel_infp</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">ICaL</span>
            <span class="o">*</span> <span class="n">a_relp</span>
            <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">25.62890625</span> <span class="o">*</span> <span class="n">HF_scaling_Jrel_inf</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">cajsr</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">tau_relp_tmp</span> <span class="o">=</span> <span class="n">btp</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.0123</span> <span class="o">/</span> <span class="n">cajsr</span><span class="p">)</span>
        <span class="n">tau_relp</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">tau_relp_tmp</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">tau_relp_tmp</span><span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">Jrelp</span> <span class="o">+</span> <span class="n">Jrel_infp</span><span class="p">)</span> <span class="o">/</span> <span class="n">tau_relp</span>
        <span class="n">fJrelp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">Jrel</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fJrelp</span><span class="p">)</span> <span class="o">*</span> <span class="n">Jrelnp</span> <span class="o">+</span> <span class="n">Jrelp</span> <span class="o">*</span> <span class="n">fJrelp</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale_popu_KRyR</span>

        <span class="c1"># Expressions for the calcium buffers component</span>
        <span class="n">Jupnp</span> <span class="o">=</span> <span class="mf">0.004375</span> <span class="o">*</span> <span class="n">cai</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.00092</span> <span class="o">+</span> <span class="n">cai</span><span class="p">)</span>
        <span class="n">Jupp</span> <span class="o">=</span> <span class="mf">0.01203125</span> <span class="o">*</span> <span class="n">cai</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.00075</span> <span class="o">+</span> <span class="n">cai</span><span class="p">)</span>
        <span class="n">fJupp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">KmCaMK</span> <span class="o">/</span> <span class="n">CaMKa</span><span class="p">)</span>
        <span class="n">Jleak</span> <span class="o">=</span> <span class="mf">0.0002625</span> <span class="o">*</span> <span class="n">cansr</span> <span class="o">*</span> <span class="n">scale_popu_Kleak</span> <span class="o">*</span> <span class="n">HF_scaling_Jleak</span>
        <span class="n">Jup</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">Jleak</span>
            <span class="o">+</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fJupp</span><span class="p">)</span> <span class="o">*</span> <span class="n">Jupnp</span> <span class="o">+</span> <span class="n">Jupp</span> <span class="o">*</span> <span class="n">fJupp</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">scale_popu_KSERCA</span>
            <span class="o">*</span> <span class="n">HF_scaling_Jup</span>
        <span class="p">)</span>
        <span class="n">Jtr</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">cansr</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">cajsr</span>

        <span class="c1"># Expressions for the intracellular concentrations component</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="n">JdiffNa</span> <span class="o">*</span> <span class="n">vss</span> <span class="o">/</span> <span class="n">vmyo</span> <span class="o">+</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">INa</span> <span class="o">-</span> <span class="n">INaL</span> <span class="o">-</span> <span class="n">INab</span> <span class="o">-</span> <span class="n">Isac_P_ns</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">INaCa_i</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">INaK</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">Acap</span> <span class="o">/</span> <span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">vmyo</span><span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">JdiffNa</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">ICaNa</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">INaCa_ss</span><span class="p">)</span> <span class="o">*</span> <span class="n">Acap</span> <span class="o">/</span> <span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">vss</span><span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">=</span> <span class="n">JdiffK</span> <span class="o">*</span> <span class="n">vss</span> <span class="o">/</span> <span class="n">vmyo</span> <span class="o">+</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">Isac_P_k</span>
            <span class="o">-</span> <span class="n">IK1</span>
            <span class="o">-</span> <span class="n">IKb</span>
            <span class="o">-</span> <span class="n">IKr</span>
            <span class="o">-</span> <span class="n">IKs</span>
            <span class="o">-</span> <span class="n">Istim</span>
            <span class="o">-</span> <span class="n">Ito</span>
            <span class="o">-</span> <span class="n">Isac_P_ns</span> <span class="o">/</span> <span class="mf">3.0</span>
            <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">INaK</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">Acap</span> <span class="o">/</span> <span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">vmyo</span><span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">JdiffK</span> <span class="o">-</span> <span class="n">Acap</span> <span class="o">*</span> <span class="n">ICaK</span> <span class="o">/</span> <span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">vss</span><span class="p">)</span>
        <span class="n">Bcass</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mf">1.0</span>
            <span class="o">+</span> <span class="n">BSLmax</span> <span class="o">*</span> <span class="n">KmBSL</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">KmBSL</span> <span class="o">+</span> <span class="n">cass</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">BSRmax</span> <span class="o">*</span> <span class="n">KmBSR</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">KmBSR</span> <span class="o">+</span> <span class="n">cass</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">36</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">Jdiff</span>
            <span class="o">+</span> <span class="n">Jrel</span> <span class="o">*</span> <span class="n">vjsr</span> <span class="o">/</span> <span class="n">vss</span>
            <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">ICaL</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">INaCa_ss</span><span class="p">)</span> <span class="o">*</span> <span class="n">Acap</span> <span class="o">/</span> <span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">vss</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">Bcass</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">37</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Jtr</span> <span class="o">*</span> <span class="n">vjsr</span> <span class="o">/</span> <span class="n">vnsr</span> <span class="o">+</span> <span class="n">Jup</span>
        <span class="n">Bcajsr</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">csqnmax</span> <span class="o">*</span> <span class="n">kmcsqn</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">kmcsqn</span> <span class="o">+</span> <span class="n">cajsr</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">))</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">38</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">Jrel</span> <span class="o">+</span> <span class="n">Jtr</span><span class="p">)</span> <span class="o">*</span> <span class="n">Bcajsr</span>

        <span class="c1"># Expressions for the mechanics component</span>
        <span class="n">kwu</span> <span class="o">=</span> <span class="o">-</span><span class="n">kws</span> <span class="o">*</span> <span class="n">scale_popu_kws</span> <span class="o">+</span> <span class="p">(</span><span class="n">kuw</span> <span class="o">*</span> <span class="n">scale_popu_kuw</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">rw</span> <span class="o">*</span> <span class="n">scale_popu_rw</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">ksu</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">kws</span>
            <span class="o">*</span> <span class="n">scale_popu_kws</span>
            <span class="o">*</span> <span class="n">rw</span>
            <span class="o">*</span> <span class="n">scale_popu_rw</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">rs</span> <span class="o">*</span> <span class="n">scale_popu_rs</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="n">lambda_min12</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">lmbda</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">lmbda</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
        <span class="n">XS</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">XS</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">XS</span><span class="p">)</span>
        <span class="n">XW</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">XW</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">XW</span><span class="p">)</span>

        <span class="n">XU</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">TmB</span> <span class="o">-</span> <span class="n">XS</span> <span class="o">-</span> <span class="n">XW</span>
        <span class="n">gammawu</span> <span class="o">=</span> <span class="n">gammaw</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Zetaw</span><span class="p">)</span>
        <span class="c1"># gammasu = gammas*ufl.conditional(ufl.gt(Zetas*(ufl.gt(Zetas, 0)), (-1 -\</span>
        <span class="c1">#     Zetas)*(ufl.lt(Zetas, -1))), Zetas*(ufl.gt(Zetas, 0)), (-1 -\</span>
        <span class="c1">#     Zetas)*(ufl.lt(Zetas, -1)))</span>
        <span class="n">zetas1</span> <span class="o">=</span> <span class="n">Zetas</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">Zetas</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">zetas2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">Zetas</span><span class="p">)</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">Zetas</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">gammasu</span> <span class="o">=</span> <span class="n">gammas</span> <span class="o">*</span> <span class="n">Max</span><span class="p">(</span><span class="n">zetas1</span><span class="p">,</span> <span class="n">zetas2</span><span class="p">)</span>

        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">39</span><span class="p">]</span> <span class="o">=</span> <span class="n">kws</span> <span class="o">*</span> <span class="n">scale_popu_kws</span> <span class="o">*</span> <span class="n">XW</span> <span class="o">-</span> <span class="n">XS</span> <span class="o">*</span> <span class="n">gammasu</span> <span class="o">-</span> <span class="n">XS</span> <span class="o">*</span> <span class="n">ksu</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">40</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">kuw</span> <span class="o">*</span> <span class="n">scale_popu_kuw</span> <span class="o">*</span> <span class="n">XU</span>
            <span class="o">-</span> <span class="n">kws</span> <span class="o">*</span> <span class="n">scale_popu_kws</span> <span class="o">*</span> <span class="n">XW</span>
            <span class="o">-</span> <span class="n">XW</span> <span class="o">*</span> <span class="n">gammawu</span>
            <span class="o">-</span> <span class="n">XW</span> <span class="o">*</span> <span class="n">kwu</span>
        <span class="p">)</span>
        <span class="n">cat50</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">cat50_ref</span> <span class="o">*</span> <span class="n">scale_popu_CaT50ref</span> <span class="o">+</span> <span class="n">Beta1</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">lambda_min12</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">HF_scaling_cat50_ref</span>
        <span class="n">CaTrpn</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">CaTrpn</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">CaTrpn</span><span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">41</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ktrpn</span>
            <span class="o">*</span> <span class="n">scale_popu_kTRPN</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="o">-</span><span class="n">CaTrpn</span>
                <span class="o">+</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="mf">1000.0</span> <span class="o">*</span> <span class="n">cai</span> <span class="o">/</span> <span class="n">cat50</span><span class="p">,</span> <span class="n">ntrpn</span> <span class="o">*</span> <span class="n">scale_popu_nTRPN</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">CaTrpn</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">kb</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ku</span>
            <span class="o">*</span> <span class="n">scale_popu_ku</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">Trpn50</span> <span class="o">*</span> <span class="n">scale_popu_TRPN50</span><span class="p">,</span> <span class="p">(</span><span class="n">ntm</span> <span class="o">*</span> <span class="n">scale_popu_nTm</span><span class="p">))</span>
            <span class="o">/</span> <span class="p">(</span>
                <span class="mf">1.0</span>
                <span class="o">-</span> <span class="p">(</span><span class="n">rs</span> <span class="o">*</span> <span class="n">scale_popu_rs</span><span class="p">)</span>
                <span class="o">-</span> <span class="n">rw</span> <span class="o">*</span> <span class="n">scale_popu_rw</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">rs</span> <span class="o">*</span> <span class="n">scale_popu_rs</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span>
                <span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">CaTrpn</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">ntm</span> <span class="o">*</span> <span class="n">scale_popu_nTm</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span> <span class="mf">100.0</span><span class="p">),</span>
                <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">CaTrpn</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">ntm</span> <span class="o">*</span> <span class="n">scale_popu_nTm</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span>
                <span class="mf">100.0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">XU</span>
            <span class="o">*</span> <span class="n">kb</span>
            <span class="o">-</span> <span class="n">ku</span>
            <span class="o">*</span> <span class="n">scale_popu_ku</span>
            <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">CaTrpn</span><span class="p">,</span> <span class="p">(</span><span class="n">ntm</span> <span class="o">*</span> <span class="n">scale_popu_nTm</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">TmB</span>
        <span class="p">)</span>

        <span class="n">C</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">lambda_min12</span>
        <span class="n">dCd</span> <span class="o">=</span> <span class="o">-</span><span class="n">Cd</span> <span class="o">+</span> <span class="n">C</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="n">ufl</span><span class="o">.</span><span class="n">conditional</span><span class="p">(</span><span class="n">ufl</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">dCd</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">etas</span><span class="p">,</span> <span class="n">etal</span><span class="p">)</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">43</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_k</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">Cd</span> <span class="o">+</span> <span class="n">C</span><span class="p">)</span> <span class="o">/</span> <span class="n">eta</span>
        <span class="n">Bcai</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">cmdnmax</span> <span class="o">*</span> <span class="n">kmcmdn</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">elem_pow</span><span class="p">(</span><span class="n">kmcmdn</span> <span class="o">+</span> <span class="n">cai</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">))</span>
        <span class="n">J_TRPN</span> <span class="o">=</span> <span class="n">trpnmax</span> <span class="o">*</span> <span class="n">F_expressions</span><span class="p">[</span><span class="mi">41</span><span class="p">]</span>
        <span class="n">F_expressions</span><span class="p">[</span><span class="mi">44</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="n">J_TRPN</span>
            <span class="o">+</span> <span class="n">Jdiff</span> <span class="o">*</span> <span class="n">vss</span> <span class="o">/</span> <span class="n">vmyo</span>
            <span class="o">-</span> <span class="n">Jup</span> <span class="o">*</span> <span class="n">vnsr</span> <span class="o">/</span> <span class="n">vmyo</span>
            <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">ICab</span> <span class="o">-</span> <span class="n">IpCa</span> <span class="o">-</span> <span class="n">Isac_P_ns</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">INaCa_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">Acap</span> <span class="o">/</span> <span class="p">(</span><span class="n">F</span> <span class="o">*</span> <span class="n">vmyo</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">Bcai</span>

        <span class="c1"># Return results</span>
        <span class="k">return</span> <span class="n">as_vector</span><span class="p">(</span><span class="n">F_expressions</span><span class="p">)</span></div>

<div class="viewcode-block" id="ORdmm_Land.num_states"><a class="viewcode-back" href="../../simcardems.html#simcardems.ORdmm_Land.ORdmm_Land.num_states">[docs]</a>    <span class="k">def</span> <span class="nf">num_states</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">48</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;ORdmm_Land_em_coupling cardiac cell model&quot;</span></div>
</pre></div>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Simula Research Laboratory<br/>
    
        &copy; Copyright 2022, Simula Research Laboratory.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>